<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BAFS 狀元工廠 (MC Master)</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Comic Neue for Cartoon feel -->
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js" type="module"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js" type="module"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js" type="module"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        'cartoon': ['"Comic Neue"', 'cursive'],
                        'body': ['"Noto Sans TC"', 'sans-serif'],
                    },
                    colors: {
                        'brand-yellow': '#FFD93D',
                        'brand-blue': '#4D96FF',
                        'brand-green': '#6BCB77',
                        'brand-red': '#FF6B6B',
                        'brand-dark': '#2D2D2D',
                    },
                    boxShadow: {
                        'cartoon': '4px 4px 0px 0px #000000',
                        'cartoon-sm': '2px 2px 0px 0px #000000',
                        'cartoon-hover': '6px 6px 0px 0px #000000',
                    }
                }
            }
        }
    </script>

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            overflow-x: hidden;
        }
        
        .cartoon-font {
            font-family: 'Comic Neue', cursive;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-left: 2px solid black;
        }
        ::-webkit-scrollbar-thumb {
            background: #4D96FF;
            border: 2px solid black;
            border-radius: 10px;
        }

        /* Animations */
        @keyframes bounce-small {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }
        .animate-bounce-hover:hover {
            animation: bounce-small 0.5s infinite;
        }

        .cartoon-card {
            border: 3px solid black;
            border-radius: 1rem;
            box-shadow: 4px 4px 0px 0px #000000;
            transition: all 0.2s ease;
            background-color: white;
        }

        .dark .cartoon-card {
            background-color: #374151; /* gray-700 */
            box-shadow: 4px 4px 0px 0px #ffffff;
            border-color: white;
        }

        .cartoon-btn {
            border: 2px solid black;
            font-weight: bold;
            text-transform: uppercase;
            box-shadow: 3px 3px 0px 0px #000000;
            transition: all 0.1s;
        }
        .cartoon-btn:active {
            transform: translate(2px, 2px);
            box-shadow: 1px 1px 0px 0px #000000;
        }

        .dark .cartoon-btn {
            box-shadow: 3px 3px 0px 0px #ffffff;
            border-color: white;
        }
        
        /* Checkbox styling */
        .option-input:checked + div {
            background-color: #4D96FF;
            color: white;
            border-color: black;
            box-shadow: inset 2px 2px 0px 0px rgba(0,0,0,0.2);
        }

        .hidden-page {
            display: none;
        }

        /* Confetti */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #f00;
            animation: fall linear forwards;
            z-index: 9999;
        }
        @keyframes fall {
            to { transform: translateY(100vh) rotate(720deg); }
        }
        
        /* Pre-formatted text for questions to preserve newlines */
        .question-text {
            white-space: pre-line;
        }
    </style>
</head>
<body class="bg-yellow-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300 min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="sticky top-0 z-50 bg-white dark:bg-gray-800 border-b-4 border-black dark:border-white px-4 py-3 flex justify-between items-center">
        <div class="flex items-center gap-2 cursor-pointer" onclick="app.router('home')">
            <i class="fa-solid fa-graduation-cap text-3xl text-brand-blue dark:text-brand-yellow drop-shadow-[2px_2px_0_rgba(0,0,0,1)]"></i>
            <h1 class="text-2xl font-bold cartoon-font tracking-wider">BAFS <span class="text-brand-blue dark:text-brand-yellow">MC</span> 工廠</h1>
        </div>
        
        <div class="flex items-center gap-3">
            <button onclick="app.toggleDarkMode()" class="p-2 rounded-full border-2 border-black dark:border-white hover:bg-gray-100 dark:hover:bg-gray-700 transition">
                <i class="fa-solid fa-moon dark:hidden"></i>
                <i class="fa-solid fa-sun hidden dark:block text-brand-yellow"></i>
            </button>
            
            <!-- Auth Status (Anonymous) -->
            <div id="user-display" class="hidden flex items-center gap-2 text-sm font-bold border-2 border-black dark:border-white px-3 py-1 rounded-full bg-brand-green text-white shadow-cartoon-sm">
                <i class="fa-solid fa-user-secret"></i> <span id="username-span">訪客</span>
            </div>

            <!-- Mobile Menu Button -->
            <button class="md:hidden cartoon-btn bg-gray-200 dark:bg-gray-700 px-3 py-1 rounded-lg" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')">
                <i class="fa-solid fa-bars"></i>
            </button>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden md:hidden fixed inset-0 z-40 bg-black/90 flex flex-col items-center justify-center space-y-6 text-white text-2xl font-bold cartoon-font">
        <button class="absolute top-5 right-5 text-4xl" onclick="document.getElementById('mobile-menu').classList.add('hidden')">&times;</button>
        <a href="#" onclick="app.router('home'); document.getElementById('mobile-menu').classList.add('hidden')">主頁</a>
        <a href="#" onclick="app.router('mistakes'); document.getElementById('mobile-menu').classList.add('hidden')">我的錯題本</a>
        <a href="#" onclick="app.router('leaderboard'); document.getElementById('mobile-menu').classList.add('hidden')">龍虎榜</a>
    </div>

    <!-- Main Content Area -->
    <main class="flex-grow container mx-auto p-4 max-w-4xl relative">
        
        <!-- === HOME VIEW === -->
        <div id="home-view" class="space-y-8 animate-fade-in">
            <!-- Hero Section -->
            <div class="cartoon-card bg-brand-blue text-white p-6 md:p-10 text-center relative overflow-hidden">
                <div class="absolute -top-10 -right-10 w-40 h-40 bg-white/20 rounded-full"></div>
                <div class="absolute top-20 -left-10 w-20 h-20 bg-brand-yellow/30 rounded-full"></div>
                <h2 class="text-3xl md:text-5xl font-bold mb-4 cartoon-font drop-shadow-[3px_3px_0_rgba(0,0,0,1)]">BAFS 5** 生成器</h2>
                <p class="text-lg md:text-xl font-medium mb-6">歷屆試題 • 即時詳解 • 錯題重溫 • 龍虎榜</p>
                <div class="flex flex-wrap justify-center gap-4">
                    <button onclick="app.startRandomMock()" class="cartoon-btn bg-brand-yellow text-black px-6 py-3 rounded-xl text-lg hover:bg-yellow-300">
                        <i class="fa-solid fa-shuffle mr-2"></i>隨機模擬卷 (24題)
                    </button>
                    <button onclick="app.startMiniQuiz()" class="cartoon-btn bg-purple-500 text-white px-6 py-3 rounded-xl text-lg hover:bg-purple-600 shadow-cartoon">
                        <i class="fa-solid fa-stopwatch mr-2"></i>極速小測 (20題)
                    </button>
                    <button onclick="app.router('mistakes')" class="cartoon-btn bg-brand-red text-white px-6 py-3 rounded-xl text-lg hover:bg-red-500">
                        <i class="fa-solid fa-book-skull mr-2"></i>重溫錯題
                    </button>
                </div>
            </div>

            <!-- Loading Status for External Data -->
            <div id="external-loading-bar" class="hidden cartoon-card p-4 bg-blue-100 dark:bg-blue-900 border-2 border-brand-blue flex items-center justify-center gap-3">
                <i class="fa-solid fa-cloud-arrow-down fa-bounce text-brand-blue dark:text-brand-yellow text-xl"></i>
                <span class="font-bold">正在從 GitHub 載入更多題目...</span>
            </div>

            <!-- Stats Grid -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="cartoon-card p-4 text-center bg-white dark:bg-gray-800">
                    <div class="text-3xl font-bold text-brand-blue" id="stat-total-done">0</div>
                    <div class="text-sm font-bold text-gray-500 dark:text-gray-300">已做題數</div>
                </div>
                <div class="cartoon-card p-4 text-center bg-white dark:bg-gray-800">
                    <div class="text-3xl font-bold text-brand-green" id="stat-accuracy">0%</div>
                    <div class="text-sm font-bold text-gray-500 dark:text-gray-300">總正確率</div>
                </div>
                <div class="cartoon-card p-4 text-center bg-white dark:bg-gray-800">
                    <div class="text-3xl font-bold text-brand-red" id="stat-mistakes">0</div>
                    <div class="text-sm font-bold text-gray-500 dark:text-gray-300">待改錯題</div>
                </div>
                <div class="cartoon-card p-4 text-center bg-white dark:bg-gray-800 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700" onclick="app.router('leaderboard')">
                    <div class="text-3xl font-bold text-brand-yellow"><i class="fa-solid fa-trophy"></i></div>
                    <div class="text-sm font-bold text-gray-500 dark:text-gray-300">龍虎榜</div>
                </div>
            </div>

            <!-- Year Selection -->
            <div>
                <h3 class="text-2xl font-bold mb-4 flex items-center gap-2">
                    <span class="w-4 h-8 bg-brand-blue rounded-full block"></span>
                    年份練習
                </h3>
                <div class="grid grid-cols-3 md:grid-cols-5 gap-4" id="year-grid">
                    <!-- JS will populate this -->
                    <div class="col-span-3 text-center py-8 text-gray-400">正在載入題庫...</div>
                </div>
            </div>
        </div>

        <!-- === QUIZ VIEW === -->
        <div id="quiz-view" class="hidden-page pb-20">
            <!-- Quiz Header -->
            <div class="flex justify-between items-center mb-6 bg-white dark:bg-gray-800 p-4 border-b-4 border-black dark:border-white sticky top-16 z-30">
                <div class="flex flex-col">
                    <span class="text-xs font-bold text-gray-500 uppercase tracking-widest" id="quiz-mode-label">PRACTICE MODE</span>
                    <h2 class="text-xl font-bold" id="quiz-title">2023 DSE</h2>
                </div>
                <div class="flex items-center gap-4">
                    <div id="timer-display" class="text-xl font-mono font-bold bg-black text-brand-green px-3 py-1 rounded border-2 border-gray-500 hidden">
                        75:00
                    </div>
                    <button onclick="app.endQuizEarly()" class="text-sm underline text-red-500 font-bold">結束練習</button>
                </div>
            </div>

            <!-- Progress Bar -->
            <div class="w-full bg-gray-200 h-4 border-2 border-black rounded-full mb-6 relative overflow-hidden">
                <div id="quiz-progress" class="bg-brand-blue h-full transition-all duration-300" style="width: 0%"></div>
            </div>

            <!-- Question Card -->
            <div class="cartoon-card p-6 md:p-8 mb-6 relative bg-white dark:bg-gray-800">
                <!-- Top Badges Row -->
                <div class="flex justify-between items-start mb-4">
                    <!-- Progress Badge -->
                    <div class="bg-brand-yellow border-2 border-black px-3 py-1 font-bold rounded-lg shadow-sm">
                        Q<span id="q-number">1</span>
                    </div>
                    <!-- Source Year Badge -->
                    <div class="bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-xs font-bold px-3 py-1 rounded-full border border-gray-400">
                        <i class="fa-solid fa-tag mr-1"></i><span id="q-source">2024 Q1</span>
                    </div>
                </div>
                
                <div class="mt-2 mb-6 text-lg md:text-xl font-medium leading-relaxed question-text" id="q-text">
                    Loading question...
                </div>

                <!-- Options -->
                <div class="space-y-3" id="q-options">
                    <!-- Options injected by JS -->
                </div>

                <!-- Explanation Box (Hidden initially) -->
                <div id="explanation-box" class="hidden mt-6 p-4 bg-blue-50 dark:bg-blue-900/30 border-l-4 border-brand-blue rounded-r-lg animate-fade-in">
                    <h4 class="font-bold text-brand-blue mb-1"><i class="fa-solid fa-lightbulb mr-2"></i>詳解：</h4>
                    <p class="text-sm md:text-base text-gray-700 dark:text-gray-300" id="explanation-text"></p>
                </div>
            </div>

            <!-- Controls -->
            <div class="flex justify-between items-center mb-8">
                <button id="btn-prev" onclick="app.prevQuestion()" class="cartoon-btn bg-gray-200 dark:bg-gray-700 px-6 py-3 rounded-xl disabled:opacity-50">
                    <i class="fa-solid fa-arrow-left"></i> 上一題
                </button>
                
                <button id="btn-next" onclick="app.nextQuestion()" class="cartoon-btn bg-brand-blue text-white px-8 py-3 rounded-xl shadow-cartoon hover:bg-blue-600 hidden">
                    下一題 <i class="fa-solid fa-arrow-right"></i>
                </button>
                
                <button id="btn-submit" onclick="app.submitQuiz()" class="cartoon-btn bg-brand-green text-white px-8 py-3 rounded-xl shadow-cartoon hover:bg-green-600 hidden">
                    提交試卷 <i class="fa-solid fa-check"></i>
                </button>
            </div>

            <!-- Chatbox Section -->
            <div class="mt-8 pt-8 border-t-4 border-dashed border-gray-300 dark:border-gray-700">
                <h3 class="text-xl font-bold mb-4 flex items-center gap-2">
                    <i class="fa-solid fa-comments text-brand-blue"></i> 同學討論區
                </h3>
                <div class="w-full bg-white dark:bg-gray-800 rounded-xl overflow-hidden border-2 border-black shadow-cartoon-sm">
                    <script id="cid0020000427496639107" data-cfasync="false" async src="//st.chatango.com/js/gz/emb.js" style="width: 100%;height: 500px;">{"handle":"swcs-bafs","arch":"js","styles":{"a":"C8C8C8","b":100,"c":"000000","d":"000000","k":"C8C8C8","l":"C8C8C8","m":"C8C8C8","p":"10","q":"C8C8C8","r":100,"t":0,"surl":0,"allowpm":0,"fwtickm":1}}</script>
                </div>
            </div>
        </div>

        <!-- === RESULT VIEW === -->
        <div id="result-view" class="hidden-page text-center pt-10">
            <h2 class="text-4xl font-bold mb-2 cartoon-font">成績單</h2>
            <p class="text-gray-500 mb-8" id="result-subtitle">2023 DSE • Practice Mode</p>

            <div class="cartoon-card p-8 bg-white dark:bg-gray-800 mb-8 inline-block w-full max-w-md">
                <div class="flex justify-center mb-6">
                    <div class="relative w-40 h-40 flex items-center justify-center rounded-full border-8 border-brand-blue" id="score-circle">
                        <div class="text-center">
                            <div class="text-4xl font-bold" id="result-score">40</div>
                            <div class="text-sm text-gray-500">/ <span id="result-total">45</span></div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="bg-green-100 dark:bg-green-900/30 p-3 rounded-lg border-2 border-green-200 dark:border-green-800">
                        <div class="text-2xl font-bold text-green-600 dark:text-green-400" id="result-correct">0</div>
                        <div class="text-xs uppercase font-bold text-green-800 dark:text-green-200">正確</div>
                    </div>
                    <div class="bg-red-100 dark:bg-red-900/30 p-3 rounded-lg border-2 border-red-200 dark:border-red-800">
                        <div class="text-2xl font-bold text-red-600 dark:text-red-400" id="result-wrong">0</div>
                        <div class="text-xs uppercase font-bold text-red-800 dark:text-red-200">錯誤</div>
                    </div>
                </div>

                <div class="flex flex-col gap-3">
                    <div id="auto-upload-msg" class="text-sm text-green-600 font-bold hidden mb-2">
                        <i class="fa-solid fa-check"></i> 成績已自動上傳至龍虎榜
                    </div>
                    <!-- Manual upload button as backup -->
                    <button onclick="app.saveToLeaderboard(false)" class="cartoon-btn bg-brand-yellow w-full py-3 rounded-xl font-bold hover:bg-yellow-300">
                        <i class="fa-solid fa-trophy mr-2"></i>上傳分數至龍虎榜
                    </button>
                    <button onclick="app.shareResult()" class="cartoon-btn bg-gray-100 dark:bg-gray-700 dark:text-white w-full py-3 rounded-xl font-bold hover:bg-gray-200">
                        <i class="fa-solid fa-share-nodes mr-2"></i>分享成績
                    </button>
                </div>
            </div>

            <div class="flex justify-center gap-4">
                <button onclick="app.router('home')" class="cartoon-btn bg-white dark:bg-gray-700 px-6 py-3 rounded-xl">回到主頁</button>
                <button onclick="app.router('mistakes')" class="cartoon-btn bg-brand-red text-white px-6 py-3 rounded-xl">查看錯題</button>
            </div>
        </div>

        <!-- === MISTAKES VIEW === -->
        <div id="mistakes-view" class="hidden-page">
            <h2 class="text-3xl font-bold mb-6 flex items-center gap-3">
                <i class="fa-solid fa-book-skull text-brand-red"></i> 我的錯題本
                <button onclick="app.clearMistakes()" class="text-sm bg-red-100 text-red-600 px-3 py-1 rounded-full border border-red-300 hover:bg-red-200 ml-auto">
                    清除所有
                </button>
            </h2>
            <div id="mistakes-list" class="space-y-6">
                <!-- Injected via JS -->
            </div>
            <div id="no-mistakes-msg" class="text-center py-20 hidden">
                <i class="fa-solid fa-check-circle text-6xl text-green-300 mb-4"></i>
                <p class="text-xl font-bold text-gray-500">太強了！目前沒有錯題。</p>
                <button onclick="app.router('home')" class="mt-4 cartoon-btn bg-brand-blue text-white px-6 py-2 rounded-lg">去練習</button>
            </div>
        </div>

        <!-- === LEADERBOARD VIEW === -->
        <div id="leaderboard-view" class="hidden-page">
            <div class="text-center mb-8 relative">
                <h2 class="text-3xl font-bold cartoon-font bg-brand-yellow inline-block px-6 py-2 border-4 border-black rotate-[-2deg] shadow-cartoon">BAFS 龍虎榜</h2>
                <p class="mt-4 text-gray-500">Top 50 Legends</p>
                <button onclick="app.loadLeaderboard()" class="absolute right-0 top-2 text-sm bg-white border border-gray-300 px-3 py-1 rounded shadow hover:bg-gray-50">
                    <i class="fa-solid fa-rotate"></i> 刷新
                </button>
            </div>

            <div class="cartoon-card overflow-hidden bg-white dark:bg-gray-800">
                <table class="w-full text-left">
                    <thead class="bg-black text-white">
                        <tr>
                            <th class="p-4">排名</th>
                            <th class="p-4">狀元</th>
                            <th class="p-4 hidden md:table-cell">年份/模式</th>
                            <th class="p-4 text-right">分數</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboard-body">
                        <!-- JS injected -->
                    </tbody>
                </table>
            </div>
            <button onclick="app.router('home')" class="mt-8 cartoon-btn bg-white dark:bg-gray-700 w-full py-3 rounded-xl">返回</button>
        </div>

    </main>

    <!-- Footer -->
    <footer class="text-center py-8 text-gray-400 text-xs mt-auto">
        <p>BAFS MC Master © 2024</p>
    </footer>

    <!-- Modal for Mode Selection -->
    <div id="mode-modal" class="fixed inset-0 z-50 bg-black/80 hidden flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 w-full max-w-md rounded-2xl p-6 border-4 border-black shadow-[8px_8px_0_0_#fff]">
            <h3 class="text-2xl font-bold mb-2">選擇模式</h3>
            <p class="text-gray-500 mb-6" id="modal-year-title">2023 Year</p>
            
            <div class="space-y-4">
                <button onclick="app.startQuiz('practice')" class="w-full cartoon-card p-4 hover:bg-green-50 dark:hover:bg-green-900/20 flex items-center gap-4 group">
                    <div class="bg-brand-green text-white w-12 h-12 rounded-full flex items-center justify-center border-2 border-black group-hover:scale-110 transition">
                        <i class="fa-solid fa-dumbbell"></i>
                    </div>
                    <div class="text-left">
                        <div class="font-bold text-lg">練習模式</div>
                        <div class="text-xs text-gray-500">即時答案 • 無計時 • 輕鬆做</div>
                    </div>
                </button>

                <button onclick="app.startQuiz('exam')" class="w-full cartoon-card p-4 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-4 group">
                    <div class="bg-brand-red text-white w-12 h-12 rounded-full flex items-center justify-center border-2 border-black group-hover:scale-110 transition">
                        <i class="fa-solid fa-stopwatch"></i>
                    </div>
                    <div class="text-left">
                        <div class="font-bold text-lg">模擬考模式</div>
                        <div class="text-xs text-gray-500">30分鐘倒數 • 最後對卷 • 真實體驗</div>
                    </div>
                </button>
            </div>
            
            <button onclick="document.getElementById('mode-modal').classList.add('hidden')" class="mt-6 w-full py-3 text-gray-500 font-bold hover:text-black">取消</button>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="toast" class="fixed bottom-5 left-1/2 transform -translate-x-1/2 bg-black text-white px-6 py-3 rounded-full shadow-lg translate-y-20 transition-transform duration-300 z-50 flex items-center gap-2">
        <i class="fa-solid fa-info-circle text-brand-yellow"></i>
        <span id="toast-msg">Notification</span>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, orderBy, limit, getDocs, doc, setDoc, updateDoc, deleteDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

// === 1. 靜態題庫資料庫 (2024-2020) ===
        const REAL_QUESTIONS = [
            // --- 2024 年 (已確認題目) ---
            { 
                id: 202401, 
                year: "2024", 
                topic: "Business Environment", 
                question: "下列哪項是商界對香港經濟的貢獻？\n(1) 銷售貨品與服務至海外以賺取外匯\n(2) 為本地居民提供就業機會\n(3) 為政府帶來稅收", 
                options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], 
                answer: 3, 
                explanation: "商業活動能促進出口賺取外匯、創造就業職位以及增加政府利得稅收入，三者皆正確。" 
            },
            { 
                id: 202402, 
                year: "2024", 
                topic: "Management", 
                question: "與採用扁平式架構及規模相若的商號比較，下列哪項有關採用高架式架構的商號的陳述是正確的？\n(1) 中層管理人員較多。\n(2) 它能較迅速回應市場轉變。\n(3) 管理人員監督較少直屬下屬。", 
                options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], 
                answer: 1, 
                explanation: "高架式架構(Tall Structure)層級多，中層管理人員較多(1正確)；管理幅度窄，監督較少下屬(3正確)。但因層級多，訊息傳遞慢，回應市場轉變較慢(2錯誤)。" 
            },
            { 
                id: 202403, 
                year: "2024", 
                topic: "Accounting", 
                question: "下列哪項是財務報表的用途？\n(1) 用作評稅\n(2) 用作分析商號的財務資訊\n(3) 用作比較行業中不同商號的財務表現", 
                options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], 
                answer: 3, 
                explanation: "財務報表可用於稅務局評稅、管理層分析業績以及投資者比較不同公司的表現，三者皆是主要用途。" 
            },

            // --- 2023 年 ---
            { id: 202301, year: "2023", topic: "Business Environment", question: "下列哪項有關香港營商環境的陳述是正確的？\n(1) 香港天然資源豐富，可以自給自足。\n(2) 香港大多數進口的貨物來自內地。\n(3) 香港政府沒有對貨物徵收銷售稅。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 3, explanation: "香港缺乏天然資源(1錯)；內地是香港主要進口來源地(2對)；香港奉行簡單稅制，沒有徵收銷售稅(3對)。" },
            { id: 202302, year: "2023", topic: "Management", question: "下列哪項有關職權和責任的陳述是正確的？\n(1) 授權是把職權和責任交予下屬。\n(2) 前線管理人員需要職權來執行他們的責任。\n(3) 控制幅度較闊的管理人員擁有較多職權。", options: ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "控制幅度是指管理者直接管轄下屬的人數，幅度闊窄與職權多寡無直接必然關係(3錯)。" },
            { id: 202303, year: "2023", topic: "Accounting", question: "下列哪項是會計的主要功能？\n(1) 將交易按盈利能力分類。\n(2) 傳遞企業的財務表現資訊予持份者。\n(3) 歸納企業的所有資料供使用者作決策之用。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (2)", "只有 (2) 及 (3)"], answer: 1, explanation: "會計的主要功能是記錄、分類、匯總並傳遞財務資訊給使用者。會計並不記錄「所有」資料（如非財務資料），分類是按性質而非單純按盈利能力。" },
            { id: 202304, year: "2023", topic: "Finance", question: "一家銀行提供一個投資計劃，需要初始存款 $180,000。投資者可在加入該計劃時獲得 $2,000 現金回贈。在第二及第三年年初，現金流入分別為 $70,000 及 $150,000。如果貼現率為每年 5%，該投資計劃的淨現值是多少？", options: ["$14,973", "$22,721", "$24,721", "$31,429"], answer: 2, explanation: "T0現金流: -180,000 + 2,000 = -178,000。T1(第二年初)流入 $70,000 PV=$70,000/1.05。T2(第三年初)流入 $150,000 PV=$150,000/1.05^2。計算總和約為 $24,721。" },
            { id: 202305, year: "2023", topic: "Accounting", question: "下列哪項是會計循環的流程？\n(1) 作出期末調整 (2) 編製財務報表 (3) 在原始分錄簿記錄交易 (4) 編製試算表 (5) 過帳至分類帳", options: ["(3) → (5) → (4) → (1) → (2)", "(3) → (5) → (1) → (4) → (2)", "(5) → (1) → (3) → (2) → (4)", "(5) → (3) → (1) → (4) → (2)"], answer: 0, explanation: "正確順序：原始分錄簿 -> 分類帳 -> 試算表 -> 期末調整 -> 財務報表。" },
            { id: 202306, year: "2023", topic: "Business Environment", question: "何明是一家獨資商號的東主，最近他決定將商號轉為私人有限公司。下列哪項是這改變的可能原因？\n(1) 這公司是獨立的法定個體。\n(2) 這公司的股東人數沒有上限。\n(3) 這公司毋須向公眾披露其財務報表。", options: ["只有 (1)", "只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 0, explanation: "私人有限公司股東人數上限為50人(2錯)。獨資商號本身也毋須向公眾披露財務報表，故此點非轉變的誘因(3錯)。主要原因是公司具獨立法人地位，享有有限債務責任。" },
            { id: 202307, year: "2023", topic: "Accounting", question: "下列哪項交易會減低商號的淨利？\n(1) 以支票償還應付貨款。\n(2) 購買在辦公室使用的文具。\n(3) 退貨予供應商。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 1, explanation: "購買文具屬費用，會減少淨利。償還貨款和退貨只是資產與負債的變動，不涉及損益項目。" },
            { id: 202308, year: "2023", topic: "Management", question: "與獨裁式領導比較，下列哪項是機構採用民主式領導的優點？\n(1) 提升決策效率。\n(2) 促進上司與下屬之間的溝通。\n(3) 誘導下屬主動工作。", options: ["只有 (1)", "只有 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "民主式領導鼓勵參與，有助溝通(2)及提升士氣主動性(3)，但由於需要諮詢，決策速度通常較獨裁式慢(1錯)。" },
            { id: 202309, year: "2023", topic: "Finance", question: "下列哪項有關信用卡的陳述是正確的？\n(1) 批核信用卡申請前，發卡銀行可查閱申請人的個人信貸紀錄。\n(2) 申請信用卡須提供抵押品。\n(3) 持卡人若準時清付每月信用卡欠款，可獲年費豁免。", options: ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (1) 及 (3)"], answer: 0, explanation: "銀行會查閱信貸紀錄(1對)。信用卡通常是無抵押貸款(2錯)。豁免年費視乎銀行條款，非「準時還款」的必然結果(3錯)。" },
            { id: 202310, year: "2023", topic: "Accounting", question: "下列哪項交易對會計等式中的資產和資本有相同的影響？\n(1) 收到租金收益的支票。\n(2) 以東主的私人支票償還銀行貸款。\n(3) 以現金支付本月的費用。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "(1)資產升、收益令資本升。(3)資產跌、費用令資本跌。兩者均使資產與資本同方向變動。(2)是負債跌、資本升(注入資本)。" },
            { id: 202311, year: "2023", topic: "Business Environment", question: "謝富與陳威是一家貿易商號的合夥人。如果陳威是有合夥人，下列哪項有關該合夥商號的陳述是正確的？\n(1) 如果謝富退出合夥，商號就要結束營業。\n(2) 陳威不會參與合夥的管理。\n(3) 兩位合夥人的最高損失是他們投資在合夥的金額。", options: ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "普通合夥中，若合夥人退出，舊合夥解散(1對)。有限合夥人(陳威)不參與管理(2對)。普通合夥人(謝富)需負無限責任(3錯)。" },
            { id: 202312, year: "2023", topic: "Finance", question: "撇除其他因素，下列哪項會導致一家銷售電動車的上市公司的股價上升？\n(1) 有更多充電站。\n(2) 政府宣佈電動車首次登記稅寬減安排。\n(3) 科技突破提高了電動車的能源效益。", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "配套設施完善(1)、政策優惠(2)及產品技術提升(3)均有利電動車銷情，從而推高股價。" },
            { id: 202313, year: "2023", topic: "Management", question: "下列哪項有關「統一的方向」的陳述是正確的？\n(1) 有助建立團隊精神。\n(2) 避免兩位上司給予矛盾的指令。\n(3) 管理人員需定期檢視下屬的工作進度，帶來額外的行政工作。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 0, explanation: "統一方向(Unity of Direction)是指同一目標的活動由一位主管領導，有助團結(1)。(2)是「統一指揮」(Unity of Command)。" },
            { id: 202314, year: "2023", topic: "Finance", question: "下列哪項交易可提高商號的變現能力？\n(1) 東主向商號注入現金。\n(2) 商號以銀行透支獲得現金。\n(3) 商號借取一筆五年期的銀行貸款以償還應付貨款。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 2, explanation: "注入現金(1)增加流動資產，提升變現力。借長期債還短期債(3)減少流動負債，提升流動比率。透支(2)僅是流動負債形式，不一定改善比率。" },
            { id: 202315, year: "2023", topic: "Finance", question: "下列哪項有關投資者權利和責任的陳述是正確的？\n(1) 有責任在簽訂投資合約前了解合約條款。\n(2) 有權決定是否依照經紀的投資建議。\n(3) 如投資經常出現虧損，有權索償。", options: ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "投資者需自負盈虧，除非涉及違規銷售或欺詐，否則不能因虧損索償(3錯)。(1)及(2)為正確的責任與權利。" },
            { id: 202316, year: "2023", topic: "Business Environment", question: "下列哪項是《更緊密經貿關係安排》(CEPA) 為香港帶來的好處？", options: ["從內地進口香港的貨物不需繳付關稅。", "勞工可在內地與香港之間自由流動。", "香港的服務提供者在東南亞國家開發業務可享優惠待遇。", "香港的專業人士可投考內地的專業資格考試，以進入內地市場。"], answer: 3, explanation: "CEPA 容許香港專業人士參加內地資格考試及執業。A錯在香港本身是免稅港；B錯在勞工非自由流動；C錯在CEPA是關於內地而非東南亞。" },
            { id: 202317, year: "2023", topic: "Accounting", question: "一家商號簽訂合約，由 2022 年 8 月 1 日起以月租 $10,000 租用辦公室。商號於租約期首天支付首六個月的租金。根據______，截至 2022 年 12 月 31 日止年度的租金費用為______。", options: ["應計觀念 ... $50,000", "應計觀念 ... $60,000", "繼續經營假設 ... $50,000", "繼續經營假設 ... $60,000"], answer: 0, explanation: "根據應計觀念，費用應在發生時確認。2022年涉及8, 9, 10, 11, 12月共5個月。$10,000 x 5 = $50,000。" },
            { id: 202318, year: "2023", topic: "Business Environment", question: "下列哪項有關香港中小型企業 (中小企) 的陳述是正確的？\n(1) 它們為大型企業提供互補的服務和支援。\n(2) 它們服務大型企業未有涵蓋的狹窄市場。\n(3) 超過 90% 的香港企業都是中小企。", options: ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "中小企佔香港企業總數約98%，常服務利基市場(Niche Market)並支援大企業(如外判商)。三項皆正確。" },
            { id: 202319, year: "2023", topic: "Business Environment", question: "下列哪位人士毋需作強制性公積金供款？", options: ["應屆文憑試考生，18 歲，在快餐店任職暑期工，為期三個月，月入 $9,000。", "兼職辦公室文員，35 歲，月入 $7,000。", "全職商場清潔工，63 歲，月入 $8,500。", "自僱籃球教練，40 歲，月入 $18,000。"], answer: 1, explanation: "這題需小心，B選項月入$7,000低於供款下限($7,100)，僱員毋需供款，但僱主仍需供款。然而題目問「哪位人士」通常指僱員部分。註：A雖是暑期工但滿60日可能需供款，但一般豁免是家務僱員或少於60日僱用。根據答案B，重點在於入息低於下限。" },
            { id: 202320, year: "2023", topic: "Accounting", question: "陳氏電腦於 2023 年 4 月 3 日向客戶發出發票（總額 $10,200，扣除交易折扣 $500 後為 $9,700；30 天內清付，15 天內清付可享 10% 折扣）。從陳氏電腦的角度而言，下列哪項有關上述交易的會計記帳是正確的？", options: ["應貸記銷貨帳 $10,200。", "應借記銷貨折扣帳 $970。", "交易折扣 $500 應記進收貨款帳。", "應借記銀行存款帳 $9,700。"], answer: 3, explanation: "交易折扣不入帳，發票金額為 $9,700。若不涉及即時現金折扣結算，初步記錄應收帳款/銷貨為9700。選項D指「借記銀行存款」暗示客戶已付款(或題目情境隱含即時收妥)，金額為扣除交易折扣後的淨額。" },
            { id: 202321, year: "2023", topic: "Business Environment", question: "下列哪項有關香港跨國公司的陳述是正確的？\n(1) 它們也在其他國家營運。\n(2) 香港辦事處必定有從海外招聘的員工。\n(3) 它們可以是合營企業。", options: ["只有 (1)", "只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 2, explanation: "跨國公司定義為在多國營運(1)。它們可用合營方式進入市場(3)。但不一定必定有海外員工派駐(2)。" },
            { id: 202322, year: "2023", topic: "Business Environment", question: "下列哪項有關企業家貢獻的陳述是正確的？\n(1) 有助實行政府的經濟政策。\n(2) 有助促進經濟增長。\n(3) 增加市場的產品種類。", options: ["只有 (1)", "只有 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "企業家精神推動創新和生產，促進增長(2)及多樣性(3)。實行政府政策(1)通常是公營機構的角色，非企業家的直接貢獻。" },
            { id: 202323, year: "2023", topic: "Accounting", question: "截至 2023 年 3 月 31 日止年度，一家商號資料：資本結餘 (2022/4/1) $270,000、本年度毛利 $7,500、東主注入現金 $20,000、提用 $9,000、本年度淨損失 $84,000。2023 年 3 月 31 日的資本帳結餘是多少？", options: ["$157,000", "$197,000", "$204,500", "$207,500"], answer: 1, explanation: "期末資本 = 期初 $270,000 + 注入 $20,000 - 淨損失 $84,000 - 提用 $9,000 = $197,000。" },
            { id: 202324, year: "2023", topic: "Finance", question: "美莉存入一筆 $100,000 為期一年的定期存款，年利率為 4%。下列哪項有關這定期存款的陳述是正確的？\n(1) 實際年利率與名義年利率相同。\n(2) 如果六個月後的市場利率上升，存款的利率亦會上升。\n(3) 如果美莉在存入存款三個月後提取款項，她可得到利息收益 $1,000。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 0, explanation: "因為是一年期且通常每年複息一次(或單利)，實際與名義相同(1對)。定存利率鎖定，不隨市場升跌(2錯)。定存提早提款通常會罰息或無息(3錯)。" },
            { id: 202325, year: "2023", topic: "Accounting", question: "一家商號於 2022 年 1 月 1 日成立。根據以下資料（2022 銷貨 $1,200,000、2022/12/31 存貨 $115,000、2022 毛利率 40%），計算 2022 年度的購貨額：", options: ["$365,000", "$595,000", "$835,000", "$935,000"], answer: 3, explanation: "根據提供的答案鍵(D)。(註：一般計算為 銷貨成本=1.2M*(1-40%)=720,000。購貨=720,000+115,000=835,000 (C)。選 D 可能涉及隱藏假設如購貨運費或其他成本，此處依答案鍵為準。)" },
            { id: 202326, year: "2023", topic: "Finance", question: "下列哪項不是在香港聯合交易所主板上市的基本上市要求？", options: ["市值", "行政總裁的資歷", "營業紀錄", "現金流量"], answer: 1, explanation: "主板上市要求包括市值、盈利/收入/現金流量測試、營業紀錄等財務指標。行政總裁的個人資歷非硬性財務指標要求。" },
            { id: 202327, year: "2023", topic: "Business Environment", question: "下列哪項是一家超級市場履行社會責任的例子？\n(1) 向顧客提供消費獎賞計劃。\n(2) 減少貨品包裝。\n(3) 提供免費食物券予長者。", options: ["只有 (1)", "只有 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "消費獎賞是促銷推廣，屬商業策略(1錯)。減少包裝(環保)和派食物券(回饋社會)均屬企業社會責任(2, 3對)。" },
            { id: 202328, year: "2023", topic: "Accounting", question: "下列是一家成衣貿易商號的複式記帳，哪項是正確的？", options: ["客戶退回於兩星期前以現金購買的貨物：借記「銷貨」、貸記「現金」", "商號支付購買貨物的運費：借記「購貨運費」、貸記「購貨」", "商號以賒帳方式出售辦公室電腦：借記「應收帳款」、貸記「銷貨」", "商號以現金購買辦公室打印機的墨水：借記「雜費」、貸記「現金」"], answer: 3, explanation: "A應借記「銷貨退回」。B應貸記「現金/銀行」。C出售非流動資產不可記「銷貨」。D購買消耗品記雜費或文具，分錄正確。" },
            { id: 202329, year: "2023", topic: "Finance", question: "下列哪項有關公司債券持有人的陳述是正確的？", options: ["債券持有人在公司周年大會中有投票權。", "債券持有人有權分享公司的利潤。", "如果公司清盤，債券持有人可在公司償還股東投資後取回本金。", "即使公司錄得虧損，債券持有人仍可定期收取固定利息。"], answer: 3, explanation: "債券是債務，利息是必須支付的費用，與公司盈虧無關。債券持有人是債權人，無投票權(A)，不分享利潤(B)，清盤時優先於股東受償(C錯)。" },
            { id: 202330, year: "2023", topic: "Management", question: "美味集團是一家本地連鎖餐廳，根據其組織圖（層階 A: 總經理；層階 B: 人力資源經理、營運經理、市場營銷經理；層階 C: 經理(中國)、經理(韓國)、經理(日本)）。人力資源經理對營運經理有______職權。層階 C 是按______劃分部門。", options: ["幕僚 ... 產品", "幕僚 ... 地區", "直線 ... 產品", "直線 ... 地區"], answer: 0, explanation: "人力資源經理提供建議，屬幕僚職權。層階C為不同國家，理應為地區劃分，但根據提供的答案鍵 (A)，選項顯示為「產品」。(註：按常理應選 B，此處依答案鍵 A 輸出)。" },

            // --- 2022 年 ---
            { id: 202201, year: "2022", topic: "Business Environment", question: "下列哪項有關香港營商環境的陳述是正確的？\n(1) 香港是亞太區經濟合作組織及世界貿易組織的成員。\n(2) 香港的本地生產總值主要來自第二級產業。\n(3) 在香港賺取利潤的企業須繳納薪俸稅。", options: ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (1) 及 (2)"], answer: 0, explanation: "香港是亞太經合組織 (APEC) 及世貿 (WTO) 成員 (1對)；GDP 主要來自第三級服務業而非第二級 (2錯)；企業須繳納利得稅而非薪俸稅 (3錯)。" },
            { id: 202202, year: "2022", topic: "Business Environment", question: "下列哪項有關香港中小型企業（中小企）的陳述是正確的？\n(1) 大多數中小企從事進出口貿易及批發行業。\n(2) 資產總值低於一百萬元的企業屬中小企。\n(3) 中小企聘用了大約 90% 的勞動力。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 0, explanation: "進出口貿易是主要的中小企行業 (1對)。製造業聘用少於 100 人或非製造業少於 50 人為界定，非資產值 (2錯)。中小企聘用約 45% 的私營機構僱員，非 90% (3錯)。" },
            { id: 202203, year: "2022", topic: "Accounting", question: "一家商號的會計文員正編製試算表和財務報表，其後會向經理呈交相關資訊。上述情況屬於哪項會計功能？\n(1) 溝通 (2) 記錄 (3) 歸納", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 2, explanation: "編製財務報表屬於「歸納」功能 (3)，向經理呈交資訊屬於「溝通」功能 (1)。" },
            { id: 202204, year: "2022", topic: "Accounting", question: "如果一家商號的期末存貨減少及銷貨運費增加，這對商號的毛利和淨利會有什麼影響？", options: ["毛利增加、淨利增加", "毛利增加、淨利不變", "毛利減少、淨利減少", "毛利減少、淨利不變"], answer: 2, explanation: "期末存貨減少導致銷貨成本上升，毛利減少。銷貨運費是費用，增加會導致淨利進一步減少。" },
            { id: 202205, year: "2022", topic: "Finance", question: "2021 年 4 月 1 日，大偉存入銀行帳戶 $300,000。存款年利率為 4%，每季複息計算。2021 年 12 月 31 日大偉可得到的利息總額為：", options: ["$8,000", "$8,080", "$9,000", "$9,090"], answer: 3, explanation: "存款期為 9 個月 (3 季)。本利和 = $300,000 \\times (1 + 4\\%/4)^3 = $309,090.3$。利息 = $9,090$。" },
            { id: 202206, year: "2022", topic: "Business Environment", question: "下列哪項有關合營企業的陳述是正確的？\n(1) 合營企業必須向公眾披露其財務報表。\n(2) 合營企業是獨立於合營企業合夥人的個體。\n(3) 投資最多資本的合營企業合夥人在業務營運上有最終決定權。", options: ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (2) 及 (3)"], answer: 1, explanation: "合營企業通常不需向公眾披露 (1錯)。權力通常由合約規定而非單看資本 (3錯)。(2) 指出其獨立個體的特性。" },
            { id: 202207, year: "2022", topic: "Management", question: "下列哪項是採用「目標管理」的好處？\n(1) 減少下屬的工作量 (2) 有助監察下屬的工作進度 (3) 激勵下屬達成公司目標", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "目標管理 (MBO) 有助評估進度 (2) 及透過參與設定目標激勵員工 (3)，但不一定能減少工作量，反而可能增加文書工作 (1錯)。" },
            { id: 202208, year: "2022", topic: "Accounting", question: "下列哪項是試算表的功能？\n(1) 找出分類帳戶的錯誤 (2) 有助編製原始分錄簿 (3) 檢視財務報表是否計算準確", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 0, explanation: "試算表用於檢查分類帳的算術準確性 (1)。它在原始分錄簿之後編製 (2錯)，並在財務報表之前編製 (3錯)。" },
            { id: 202209, year: "2022", topic: "Finance", question: "下列哪項有關恆生指數的陳述是正確的？\n(1) 在計算指數時包括所有在香港聯合交易所上市的股票。\n(2) 它是評估個別上市公司股票價格走勢的指標，有助投資決定。\n(3) 它反映在香港聯合交易所主板上市股票的整體價格水平。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 3, explanation: "恆指只包括成份股而非所有股票 (1錯)。它可作個別股價評估參考 (2) 及反映市場整體表現 (3)。" },
            { id: 202210, year: "2022", topic: "Accounting", question: "下列哪項複式記帳是正確的？\n(1) 收到退貨予供應商的現金退款：借記「現金」、貸記「購貨退出」\n(2) 以支票支付送貨給顧客的運費：借記「銷貨運費」、貸記「銀行存款」\n(3) 退回賒購的辦公室設備予賣家：借記「應付帳款」、貸記「辦公室設備」", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "三項分錄均正確。(1) 現金增加且購貨成本減少；(2) 費用增加且銀行存款減少；(3) 負債減少且資產減少。" },
            { id: 202211, year: "2022", topic: "Business Environment", question: "一家外國商號在香港設立零售商店。下列哪項是影響該商號的經濟因素？\n(1) 顧客對國際品牌的喜好 (2) 外幣匯率 (3) 香港的就業水平", options: ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (2) 及 (3)"], answer: 3, explanation: "顧客喜好屬社會文化因素 (1)。匯率 (2) 及就業水平 (3) 屬經濟因素。" },
            { id: 202212, year: "2022", topic: "Accounting", question: "2022 年 1 月 1 日，黃氏商號的資產總值為 $100,000。1 月 3 日，商號以賒帳方式購入成本 $30,000 的貨物。1 月 31 日，商號以賒帳方式售出成本 $8,000 的貨物，售價為 $12,000。計算 2022 年 1 月 31 日黃氏商號的資產總值：", options: ["$122,000", "$126,000", "$134,000", "$142,000"], answer: 2, explanation: "期初 $100,000 + 賒購貨物 $30,000 (存貨增) - 售出貨物成本 $8,000 (存貨減) + 應收貨款 $12,000 (資產增) = $134,000。" },
            { id: 202213, year: "2022", topic: "Finance", question: "撇除其他因素，下列哪項政府政策會導致一家連鎖快餐店的股價上升？\n(1) 向市民發放電子消費券 (2) 提高股票印花稅率 (3) 放寬因 2019 冠狀病毒病推行的社交距離措施", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "消費券 (1) 及放寬措施 (3) 均刺激消費，利好快餐店業務及股價。提高印花稅 (2) 增加交易成本，通常不利股價。" },
            { id: 202214, year: "2022", topic: "Accounting", question: "陳氏商號以每件定價 $80 銷售貨物。2022 年 3 月 10 日，商號售出 1,200 件貨物予一客戶（帳戶摘錄顯示銷貨 $84,000）。根據以上資料，下列哪項陳述是正確的？\n(1) 貨物是以賒帳方式出售的。 (2) 給予該客戶折扣每件 $10。 (3) 銷貨折扣帳記錄了給予該客戶的折扣。", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "定價總額 $1,200 \\times 80 = 96,000$。實際銷貨 $84,000。折扣 = $(96,000-84,000)/1,200 = 10$ 元/件 (2對)。此為交易折扣，不記入帳簿 (3錯)。帳戶摘錄暗示有客戶戶口，即賒銷 (1對)。" },
            { id: 202215, year: "2022", topic: "Management", question: "下列哪項有關直線職權和幕僚職權的陳述是正確的？\n(1) 營運經理對銷售助理有直線職權。 (2) 資訊管理經理有幕僚職權，支援市場營銷經理。 (3) 人力資源經理對所有員工都有直線職權。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 1, explanation: "資訊經理提供專業支援，屬幕僚職權 (2對)。營運經理與銷售助理屬不同部門，通常無直線職權 (1錯)。HR 對其他部門員工只有功能/幕僚職權而非直線指揮權 (3錯)。" },
            { id: 202216, year: "2022", topic: "Accounting", question: "下列哪項應列示在資本帳的貸方？\n(1) 商號錄得的虧損 (2) 東主以私人財產支付的辦公室費用 (3) 商號向東主的朋友借貸", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 1, explanation: "資本帳貸方表示資本增加。代付費用視為注入資本 (2對)。虧損 (1) 和提用記借方。向朋友借貸屬負債，不影響資本 (3錯)。" },
            { id: 202217, year: "2022", topic: "Finance", question: "美芝的個人信貸評級差劣。下列哪項是差劣的個人信貸評級對她的影響？\n(1) 債權人會申請她破產。 (2) 她很可能需要支付較高的貸款利息。 (3) 她的信用卡申請或會不獲批准。", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "信貸評級差會導致借貸成本高 (2) 及申請困難 (3)。債權人申請破產是因欠債不還，而非單因評級差 (1)。" },
            { id: 202218, year: "2022", topic: "Management", question: "蘇珊是一家貿易公司的總經理。公司有兩位助理總經理，分別督導三位及四位部門經理。每位部門經理督導超過十名前線員工。根據以上資料，下列哪項有關該公司的陳述是正確的？", options: ["蘇珊的控制幅度是九。", "這是一家中小型企業。", "與有三層階層的公司比較，它是扁平式組織。", "與規模相若而有三層階層的公司比較，它的決策過程相對較慢。"], answer: 3, explanation: "該公司有四層架構 (GM-AGM-Mgr-Staff)，屬高聳結構。與三層 (較扁平) 相比，高聳結構的訊息傳遞和決策通常較慢 (D對)。蘇珊直接管理 2 人，幅度為 2 (A錯)。" },
            { id: 202219, year: "2022", topic: "Accounting", question: "根據葉氏商號 2021 年 12 月 31 日資料（存貨 $71,000、銀行透支 $18,000、應付貨款 $86,000、應收貨款 $162,000），2021 年 12 月 31 日的速動比率是：", options: ["1.56:1", "2.09:1", "2.24:1", "2.71:1"], answer: 0, explanation: "速動比率 = (流動資產 - 存貨) / 流動負債。此處流動資產假設只有應收和存貨，流動負債為透支和應付。($162,000$) / ($18,000 + $86,000$) = $162,000 / 104,000 \\approx 1.56:1$。" },
            { id: 202220, year: "2022", topic: "Accounting", question: "根據葉氏商號資料（資本 2021/1/1 $420,000、2021 年度淨利 $155,000、提用 $11,000），2021 年度的運用資金報酬率是：", options: ["26.96%", "31.16%", "31.50%", "36.90%"], answer: 2, explanation: "期初資本 $420,000。期末資本 = $420,000 + 155,000 - 11,000 = $564,000。平均資本 = $(420,000 + 564,000)/2 = $492,000。ROCE = $155,000 / 492,000 \\approx 31.5\\%$。" },
            { id: 202221, year: "2022", topic: "Business Environment", question: "下列哪家是跨國公司？\n(1) 一家從泰國購買原材料的香港公司。 (2) 一家在香港發行債券籌集資金的內地公司。 (3) 一家在新加坡設立分行的香港公司。", options: ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (2) 及 (3)"], answer: 2, explanation: "跨國公司定義為在多個國家擁有業務運作 (如分行)。(1) 僅是進口貿易，(2) 僅是融資活動，(3) 設立分行涉及直接投資與營運，符合定義。" },
            { id: 202222, year: "2022", topic: "Finance", question: "一家大型公司設有不同功能部門，下列哪項是該公司財務部門的工作？\n(1) 監控公司的現金流 (2) 審視升級資訊管理系統的預算 (3) 決定會計文員的薪金水平", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "監控現金流及預算審視均屬財務部門職責 (1, 2對)。決定薪金水平通常是人力資源部的職責 (3錯)。" },
            { id: 202223, year: "2022", topic: "Management", question: "何明是一家商號的高級設計師，商號大多數員工都具創意。何明向設計師提供指引，審視他們的程式設計初稿，然後與他們討論審視結果，並邀請他們參與挑選程式設計。根據以上資料，何明採用了：", options: ["統一命令", "統一的方向", "自由放任式領導", "民主式領導"], answer: 3, explanation: "何明邀請員工參與討論和挑選 (決策)，展現了民主式/參與式領導的特徵。" },
            { id: 202224, year: "2022", topic: "Finance", question: "下列哪項是股票投資者的權利？\n(1) 收取投資交易結單 (2) 收取穩定的股息收益 (3) 參與公司的日常營運", options: ["只有 (1)", "只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 0, explanation: "股票股息不穩定且非保證 (2錯)。股東不參與日常營運，那是管理層的責任 (3錯)。收取結單是基本權益 (1對)。" },
            { id: 202225, year: "2022", topic: "Business Environment", question: "下列哪項有關特許經營企業的陳述是正確的？\n(1) 如他的特許經營業務蒙受損失，特許權使用人毋須向特許權擁有人支付特許權使用費。 (2) 特許權擁有人及其所有特許權使用人均在同一國家經營業務。 (3) 如得到特許權擁有人的批准，特許權使用人可以採用與其他特許權使用人不同的營運模式。", options: ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (2) 及 (3)"], answer: 2, explanation: "特許權費通常按營業額計算，與盈虧無關 (1錯)。特許經營可跨國 (2錯)。在批准下可作適度調整以適應當地市場 (3對)。" },
            { id: 202226, year: "2022", topic: "Finance", question: "______ 和 ______ 均可能資產增值或減值，而後者會提供利息作為投資者的回報。", options: ["(1) 股票、(2) 定期存款", "(1) 股票、(2) 債券", "(1) 債券、(2) 定期存款", "(1) 債券、(2) 股票"], answer: 1, explanation: "股票和債券價格均會波動 (資產增值/減值)。債券 (後者) 提供利息，股票提供股息。定期存款通常無資本價格變動風險。" },
            { id: 202227, year: "2022", topic: "Business Environment", question: "下列哪項有關強制性公積金（強積金）制度的陳述是正確的？", options: ["僱員、自僱人士和僱主均可選擇在強制性供款以外，作出額外的自願性供款。", "僱員如於 60 歲前退休，可即時提取強積金。", "兼職員工可豁免參加強積金計劃。", "月入 $40,000 的僱員每月須供款 $2,000。"], answer: 0, explanation: "提取年齡一般為 65 歲 (B錯)。兼職除非受僱少於 60 日等豁免條件否則須參加 (C錯)。月入 $40,000 供款上限為 $1,500 (D錯)。" },
            { id: 202228, year: "2022", topic: "Business Environment", question: "下列哪項有關《更緊密經貿關係的安排》(CEPA) 的描述是正確的？", options: ["香港與內地互認所有專業資格。", "所有內地企業均可申請在香港聯合交易所主板上市。", "香港企業如將總部遷移至內地，可向內地政府申請免息貸款。", "所有香港原產的貨物進口內地時，均可享有零關稅優惠。"], answer: 3, explanation: "專業資格互認僅限部分 (A錯)。上市須符合規定非所有均可 (B錯)。零關稅是 CEPA 貨物貿易的主要優惠 (D對)。" },
            { id: 202229, year: "2022", topic: "Accounting", question: "截至 2021 年 12 月 31 日止年度的淨利是多少？（根據給定試算表資料及期末存貨 $14,000）", options: ["$28,100", "$33,100", "$39,100", "$30,600"], answer: 1, explanation: "（註：題目資料中缺失具體試算表數據，此答案根據 2022 年試卷官方答案鍵 B 判定，數值為 $33,100。）" },
            { id: 202230, year: "2022", topic: "Accounting", question: "正確排列試算表內的帳戶結餘後，(Y) 的數值為：", options: ["$14,800", "$30,400", "$35,400", "$121,400"], answer: 1, explanation: "（註：題目資料中缺失具體試算表數據，此答案根據 2022 年試卷官方答案鍵 B 判定，數值為 $30,400。）" },

            // --- 2021 年 ---
            { id: 202101, year: "2021", topic: "Business Environment", question: "下列哪項有關世界貿易組織的陳述是正確的？\n(1) 它執行成員之間的國際貿易規則。\n(2) 它協助發展中國家增加貿易機會。\n(3) 它消除成員之間的貿易障礙。", options: ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "世貿組織負責執行貿易協定及協助發展中國家 (1, 2對)；其目標是「減少」而非完全「消除」所有障礙 (3略有保留，但在DSE常規中，消除所有障礙通常被視為過於絕對，且選項B為最佳答案)。" },
            { id: 202102, year: "2021", topic: "Management", question: "按產品劃分部門的意思是指：", options: ["不同部門服務不同國家的顧客", "為不同市場發展不同的產品線", "工人按生產程序分工", "產品的生產、市場營銷及其他相關工作均由一位經理負責"], answer: 3, explanation: "按產品劃分部門 (Product Departmentalization) 意味著圍繞特定產品將所有相關職能（如生產、營銷）歸於同一部門管理。" },
            { id: 202103, year: "2021", topic: "Accounting", question: "一家零售店的簿記員於年終時結平帳戶，列出帳戶結餘，並編製試算表。該簿記員執行了以下哪項會計功能？", options: ["記錄", "分類", "歸納", "溝通"], answer: 2, explanation: "編製試算表是將分類帳資料進行匯總，屬於「歸納」 (Summarizing) 階段。" },
            { id: 202104, year: "2021", topic: "Finance", question: "文妮正考慮一項三年期的投資項目，詳情如下：第一年初流出 $70,000；第二年初流入 $25,000；第三年初流入 $35,000。該項目終結時的殘值為 20,000，貼現率為每年 5%。該項目的淨現值是多少？", options: ["-$14,445", "$187", "$2,832", "$3,520"], answer: 2, explanation: "計算現值：-$70,000 + $25,000/1.05 + $35,000/(1.05^2) + $20,000/(1.05^3) ≈ $2,832。" },
            { id: 202105, year: "2021", topic: "Management", question: "下列哪項不是授權的好處？", options: ["提高下屬的工作滿足感", "改善上司與下屬的關係", "為下屬提供培訓機會", "讓上司專注於重要的工作"], answer: 1, explanation: "授權的主要好處包括激勵下屬 (A)、培訓 (C) 及讓上司專注策略 (D)。雖然可能有助關係，但在考試標準答案中，改善關係通常不是授權的直接或主要定義性好處。" },
            { id: 202106, year: "2021", topic: "Accounting", question: "2021 年 2 月 1 日，李先生及成立一家售賣電腦的零售商號。同日，該商號從供應商賒購十台電腦，每台成本 $4,500。在 2 月，這商號把兩台損壞的電腦退回供應商，並售出三台電腦，每台售價 $7,000。2021 年 2 月 28 日，該商號購貨帳的結餘是多少？", options: ["$22,500", "$31,500", "$36,000", "$45,000"], answer: 3, explanation: "購貨帳只記錄購買成本：10 台 x $4,500 = $45,000。退貨記在「購貨退出帳」，銷貨記在「銷貨帳」，不影響購貨帳餘額。" },
            { id: 202107, year: "2021", topic: "Business Environment", question: "下列哪項是影響一家香港餐館營運的法律因素？\n(1) 最低工資水平上調。\n(2) 因 2019 冠狀病毒病擴散，公眾地方羣組聚集的人數受到限制。\n(3) 消費物價指數下降。", options: ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (1) 及 (2)"], answer: 3, explanation: "最低工資 (1) 及限聚令 (2) 均屬法律/法規因素。CPI (3) 屬經濟因素。" },
            { id: 202108, year: "2021", topic: "Management", question: "下列哪項有關有效管理原則所帶來的好處是正確的？", options: ["平衡職權和責任 —— 改善員工之間的溝通", "分工 —— 減少生產延誤", "統一命令 —— 減少工作混亂", "目標管理 —— 減少行政工作"], answer: 2, explanation: "統一命令 (Unity of Command) 確保員工只受一人指揮，能減少混亂 (C對)。目標管理通常會增加行政/文書工作 (D錯)。" },
            { id: 202109, year: "2021", topic: "Accounting", question: "2020 年 12 月 31 日，李氏商號的帳戶結餘如下：應收帳款 $55,000；銀行透支 $2,500；存貨 $21,200；貸款予陳先生 $18,000；現金 $23,000；應付帳款 $42,300；設備 $121,000。2020 年 12 月 31 日資本帳的結餘是多少？", options: ["$157,400", "$162,400", "$193,400", "$198,400"], answer: 2, explanation: "資產 = 55,000+21,200+18,000+23,000+121,000 = $238,200。負債 = 2,500+42,300 = $44,800。資本 = 資產 - 負債 = $193,400。" },
            { id: 202110, year: "2021", topic: "Finance", question: "下列哪項是銀行透支與私人貸款的分別？", options: ["利率：銀行透支較低，私人貸款較高", "還款安排：銀行透支靈活，私人貸款固定", "預先批核信貸額：銀行透支沒有，私人貸款有", "每月最低還款額：銀行透支有，私人貸款沒有"], answer: 1, explanation: "透支還款靈活 (隨時存入即可)，私人貸款通常需分期定額還款 (B對)。透支利率通常較高 (A錯)。" },
            { id: 202111, year: "2021", topic: "Accounting", question: "下列哪項會減少商號的毛利？\n(1) 提用貨品 (2) 購貨運費增加 (3) 電費增加", options: ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (1) 及 (2)"], answer: 1, explanation: "購貨運費 (Carriage Inwards) 增加銷貨成本，從而減少毛利 (2對)。電費只影響淨利 (3錯)。提用貨品會扣減購貨，反而避免了毛利被低估，不會減少毛利 (1錯)。" },
            { id: 202112, year: "2021", topic: "Business Environment", question: "下列哪項是公營公司的特徵？\n(1) 政府參與日常營運。\n(2) 董事局主席由政府委任。\n(3) 它是獨立的法定個體。", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "公營公司 (如機管局) 是獨立法定個體，主席由政府委任，但政府通常不直接參與「日常」營運 (1錯)。" },
            { id: 202113, year: "2021", topic: "Accounting", question: "下列哪項有關試算表的陳述是正確的？\n(1) 如試算表平衡，帳戶結餘沒有錯誤。\n(2) 試算表顯示所有帳戶的結餘。\n(3) 如帳戶的借方總額較貸方總額少，這帳戶的結餘會顯示在試算表的貸方列。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 3, explanation: "平衡不代表無誤 (1錯)。試算表列出所有帳戶結餘 (2對)。借方 < 貸方 = 貸方餘額 (Credit Balance)，列在貸方列 (3對)。" },
            { id: 202114, year: "2021", topic: "Finance", question: "下列哪項對個人的信貸評級有負面影響？\n(1) 有破產紀錄 (2) 曾經沒有如期償還貸款 (3) 失業超過一年", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "信貸評級主要基於過往信貸紀錄 (破產、遲還款)。失業本身不直接記錄在信貸報告 (TU) 中，雖然銀行審批時會考慮，但不屬於信貸評級機構的評分項目。" },
            { id: 202115, year: "2021", topic: "Accounting", question: "下列哪項有關財務狀況表的陳述是正確的？\n(1) 它顯示商號的變現能力。\n(2) 非流動資產按其總額由大至小排列。\n(3) 它顯示商號某段時間的財務狀況。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 0, explanation: "財務狀況表顯示某「時點」(As at) 的狀況而非某段時間 (3錯)。資產按流動性/持久性排列，非金額大小 (2錯)。透過營運資金可顯示變現能力 (1對)。" },
            { id: 202116, year: "2021", topic: "Business Environment", question: "下列哪家商號在 2019 冠狀病毒病擴散下向持份者履行社會責任？\n(1) 一家室內設計公司容許僱員在家工作。\n(2) 一家餐館向堂食顧客提供折扣。\n(3) 一家出版社讓公眾經互聯網免費閱讀其書本。", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "在家工作保障員工 (1)，免費閱讀回饋社會 (3)。疫情下鼓勵堂食 (2) 可能增加傳播風險，未必被視為履行社會責任的正面例子。" },
            { id: 202117, year: "2021", topic: "Management", question: "一家新成立的電動車製造商設定目標如下：「我們將在下半年成為電動車市場的領導者。」這目標符合以下哪項良好目標的準則？\n(1) 具體的 (2) 具時限的 (3) 可量度的", options: ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (1) 及 (2)"], answer: 1, explanation: "「下半年」具時限性 (2)。但「市場領導者」定義含糊 (市佔率？利潤？)，欠缺具體數字指標，故不夠具體 (1) 和可量度 (3)。" },
            { id: 202118, year: "2021", topic: "Accounting", question: "2020 年 12 月 31 日，新輝公司決定於三個月後結束營業。同日，它的非流動資產記錄為 $3,800,000，而其清算值則為 $2,098,000。根據哪項會計概念，新輝公司於財務狀況表中的資產計值應為多少？", options: ["繼續經營假設 …… $2,098,000", "繼續經營假設 …… $3,800,000", "歷史成本概念 …… $2,098,000", "歷史成本概念 …… $3,800,000"], answer: 0, explanation: "因公司將結束，繼續經營假設 (Going Concern) 不再適用。因此，資產應以變現淨值 ($2,098,000) 入帳。這決定是基於對「繼續經營假設」狀態的評估（即因為該假設被推翻）。" },
            { id: 202119, year: "2021", topic: "Business Environment", question: "企業編製道德守則的主要原因是甚麼？", options: ["法例規定", "可以降低生產成本", "可以改善公司的形象，賺取最高利潤", "為僱員提供規則和標準"], answer: 3, explanation: "道德守則的主要目的是為員工提供行為指引、規則和標準 (D)。" },
            { id: 202120, year: "2021", topic: "Business Environment", question: "下列哪項有關強制性公積金（強積金）制度的陳述是正確的？\n(1) 僱員可在強制供款以外，向強積金計劃作出自願性供款。\n(2) 林先生是一名司機，現年 68 歲，月入 $10,000，他須向強積金計劃每月供款 $500。\n(3) 陳先生是一名自僱小販，去年淨收入為 $120,000，他須向強積金計劃供款 $6,000。", options: ["只有 (1)", "只有 (1) 及 (2)", "只有 (1) 及 (3)", "(2) 及 (3)"], answer: 0, explanation: "自願供款是允許的 (1對)。65 歲以上獲豁免 (2錯)。雖然 (3) 看似計算正確 (120k * 5% = 6k)，但DSE答案指出只有 (1) 正確，可能因題目細節定義（如小販豁免或「淨收入」字眼非「有關入息」）而不成立。" },
            { id: 202121, year: "2021", topic: "Business Environment", question: "下列哪項有關香港中小型企業（中小企）的陳述是正確的？", options: ["中小企的規模較細，未能實行分工。", "東主承擔有限債務責任。", "大多數中小企從事次級產業。", "聘用少於 50 名員工的非製造業公司屬中小企。"], answer: 3, explanation: "這是香港政府對非製造業中小企的定義 (D對)。中小企多為第三級產業 (C錯)，且多為無限公司 (B錯)。" },
            { id: 202122, year: "2021", topic: "Accounting", question: "截至 2020 年 12 月 31 日止年度，順記（銷貨 $8,800k、銷貨成本 $2,400k、營業費用 $2,800k）與錦記（銷貨 $15,000k、銷貨成本 $2,600k、營業費用 $9,800k）的資料比較，下列哪項陳述是正確的？", options: ["錦記的毛利較低。", "錦記的運用資金報酬率較高。", "錦記在控制營業費用的表現較佳。", "錦記的淨利率較低。"], answer: 3, explanation: "順記淨利率 = 3600/8800 = 40.9%；錦記淨利率 = 2600/15000 = 17.3%。故錦記淨利率較低 (D對)。" },
            { id: 202123, year: "2021", topic: "Finance", question: "下列哪項有關債券的陳述是正確的？\n(1) 承擔風險能力較低的投資者通常偏向投資債券多於股票。\n(2) 如市場利率上升，債券持有人會收取較高利息。\n(3) 債券持有人可於到期日取回本金。", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "債券風險通常低於股票 (1對)。債券票面息率固定，不隨市場利率上升而增加 (市場利率升會導致債價跌) (2錯)。到期取回本金 (3對)。" },
            { id: 202124, year: "2021", topic: "Business Environment", question: "下列哪項是全球一體化對香港的好處？\n(1) 較易從海外招聘專家 (2) 較便宜的原料供應 (3) 減少企業之間的競爭", options: ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (1) 及 (2)"], answer: 3, explanation: "全球化促進人才流動 (1) 和採購 (2)。但通常會加劇而非減少競爭 (3錯)。" },
            { id: 202125, year: "2021", topic: "Management", question: "一家工廠的生產經理決定在 2021 年底前生產 1,000 件貨品。他已安排生產日程，並調配所需資源及人手。在計劃過程中，下一個步驟是甚麼？", options: ["評估可行方案", "制訂行動方案", "執行行動方案", "設定目標"], answer: 2, explanation: "既然已決定目標並安排好資源/方案 (Organizing/Planning done)，下一步就是「執行」(Implementation)。" },
            { id: 202126, year: "2021", topic: "Accounting", question: "下列哪項複式記帳是正確的？\n(1) 以支票向銀光公司購買一輛汽車：借「汽車」、貸「銀光公司」\n(2) 從梁先生取得佣金支票：借「銀行存款」、貸「佣金收益」\n(3) 東主以其個人支票支付商號的租金費用：借「租金費用」、貸「資本」", options: ["只有 (1)", "只有 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "(1) 支票付款應貸記「銀行存款」而非供應商。(2) 及 (3) 正確。" },
            { id: 202127, year: "2021", topic: "Finance", question: "彭力剛剛退休。他欲以公積金作投資，賺取穩定的收益。下列哪項投資工具最適合他？", options: ["恆生指數成分股", "在 GEM 上市的股票", "定期存款", "儲蓄存款"], answer: 2, explanation: "退休人士首重本金安全及穩定收益。定期存款 (C) 符合低風險及穩定利息。股票 (A, B) 風險較高，儲蓄存款 (D) 回報過低。" },
            { id: 202128, year: "2021", topic: "Management", question: "一家內地凍肉食品公司擬在香港開設分店。下列哪項是公司資訊管理經理可給予市場營銷經理的支援？\n(1) 處理有關香港凍肉食品市場的數據\n(2) 蒐集冷藏系統供應商的資料\n(3) 建立銷售人員的薪酬制度", options: ["只有 (1)", "只有 (1) 及 (2)", "只有 (1) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "資訊經理負責處理數據與系統 (1)。冷藏系統是採購或營運部，薪酬是人力資源部。" },
            { id: 202129, year: "2021", topic: "Accounting", question: "下列哪項是實帳戶的例子？", options: ["購貨帳", "應收貨款帳", "銷貨折扣帳", "電費帳"], answer: 1, explanation: "實帳戶 (Real Account) 涉及資產。應收貨款 (Asset) 是實帳戶。其他均為虛帳戶 (Nominal Accounts)。" },
            { id: 202130, year: "2021", topic: "Finance", question: "假如某投資項目的利息每半年以複息計算，下列哪項有關該項目名義回報率與實際回報率的陳述是正確的？\n(1) 該項目的實際回報率較其名義回報率高。\n(2) 如該項目的利息改為每季以複息計算，實際回報率會更高。\n(3) 如投資金額降低，該項目的實際回報率亦會降低。", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "複息頻率多於一年一次，EAR > APR (1對)。頻率越高 (每季 > 每半年)，EAR 越高 (2對)。回報率與投資本金金額無關 (3錯)。" },

            // --- 2020 年 ---
            { id: 202001, year: "2020", topic: "Forms of Business Ownership", question: "何名與徐思計劃共同創立及經營一家餐館，這餐館不會因任何一方的退出而結業。他們應採用哪一種企業擁有權類型？", options: ["合夥", "公營公司", "私人有限公司", "上市公司"], answer: 2, explanation: "「不會因任何一方退出而結業」指企業具有延續性 (Perpetual Succession)。私人有限公司是獨立法人，符合此特點，且適合兩人共同經營。" },
            { id: 202002, year: "2020", topic: "Management", question: "下列哪項是管理對企業的重要？\n(1) 善用機構資源\n(2) 建立健全的組織架構\n(3) 有效達致機構的目標", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "管理的基本職能包括計劃、組織、領導和控制，旨在透過有效的資源運用及組織結構，達成企業目標。" },
            { id: 202003, year: "2020", topic: "Accounting Principles", question: "下列哪項描述會計的「借」與「貸」是正確的？\n(1) 「借」記是增加帳戶的金額，「貸」記是減少帳戶的金額\n(2) 「借」方指帳戶的左方，「貸」方指帳戶的右方。\n(3) 「借」方結餘是正數；「貸」方結餘是負數。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (2)", "只有 (2) 及 (3)"], answer: 1, explanation: "在會計學中，「借」 (Debit) 純粹代表左方，「貸」 (Credit) 純粹代表右方。增減方向視乎帳戶性質而定（如資產借增貸減，負債則相反）。" },
            { id: 202004, year: "2020", topic: "Financial Market", question: "下列哪項有關恆生指數的描述是正確的？\n(1) 「公用事業」是恆生指數的一個分類指數。\n(2) 它顯示成分股公司的派息政策。\n(3) 它是企業籌集資金的平台。", options: ["只有 (1)", "只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 0, explanation: "恆生指數包括四個分類指數：金融、公用事業、地產、工商業。它反映股價表現而非派息政策。聯交所才是集資平台。" },
            { id: 202005, year: "2020", topic: "Accounting Equation", question: "下列哪項交易對資產、資本和負債的影響是正確的？", options: ["東主把他的汽車注入商號：資產（增加）、資本（增加）、負債（增加）", "收取客戶現金，結清其帳戶：資產（增加）、資本（不變）、負債（減少）", "東主以其私人支票為商號償還銀行貸款：資產（不變）、資本（增加）、負債（減少）", "以現金支付商號本月的租金：資產（減少）、資本（不變）、負債（減少）"], answer: 2, explanation: "東主私下代公司還債屬於資本投入。負債（銀行貸款）減少，資本增加，資產不變。" },
            { id: 202006, year: "2020", topic: "Management", question: "下列哪項有關良好 (SMART) 目標的描述是正確的？\n(1) 應是量化的\n(2) 應有預計的完成時間\n(3) 應清楚陳述達成目標的方法", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "SMART 代表 Specific (具體), Measurable (可量化), Attainable (可達成), Relevant (相關), Time-bound (具時限)。「達成方法」屬於行動計劃而非目標設定本身。" },
            { id: 202007, year: "2020", topic: "Management Principles", question: "這情境（李先生設計培訓課程並只向人力資源經理匯報）展示了下列哪項有效管理原則？\n(1) 統一的方向\n(2) 統一命令\n(3) 分工", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "全公司朝同一目標前進 (1)；只向一人匯報 (2)；經理指派專人負責特定任務 (3)。" },
            { id: 202008, year: "2020", topic: "Finance", question: "計算第三年年終現金流使 NPV 趨近於零（初始 $15,000，首兩年 $6,000，貼現率 10%）。", options: ["4 587", "5 083", "6 105", "7 965"], answer: 2, explanation: "計算過程：$15,000 = 6,000/(1.1)^1 + 6,000/(1.1)^2 + X/(1.1)^3$。$15,000 = 5,454.5 + 4,958.7 + X/1.331$。$X = (15,000 - 10,413.2) * 1.331 = 6,105$。" },
            { id: 202009, year: "2020", topic: "Accounting Ratios", question: "流動比率 1.8:1，酸性測驗比率 0.9:1。下列哪項陳述正確？", options: ["商號的營運資金金額是負數。", "商號一半的流動資產是存貨。", "商號的變現能力和盈利能力差劣。", "商號有足夠的速動資產清償流動負債。"], answer: 1, explanation: "酸性比率 = (流動資產 - 存貨) / 流動負債。1.8 - 0.9 = 0.9 (存貨佔比)。存貨 = 0.9，流動資產 = 1.8，故存貨佔流動資產的一半。" },
            { id: 202010, year: "2020", topic: "Business Environment", question: "下列哪項是香港經濟的特色？\n(1) 香港大多數企業均為中小型企業。\n(2) 香港是原材料的淨出口地。\n(3) 香港沒有對入口設置貿易障礙。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 2, explanation: "香港缺乏天然資源，是原材料的進口地。其特色是自由貿易及以中小企為主。" },
            { id: 202011, year: "2020", topic: "Accounting", question: "下列哪項是使用財務報表的局限？\n(1) 財務報表主要記錄過去的交易。\n(2) 一般會以市值匯報資產價值。\n(3) 不同商號會採用不同的會計方法。", options: ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "財務報表通常使用「歷史成本原則」而非市值。 (1) 和 (3) 是典型的局限性。" },
            { id: 202012, year: "2020", topic: "Management", question: "銀行設有存款、貸款等部門（按產品），下設地區分部。劃分部門方式：\n(1) 按產品 (2) 按功能 (3) 按地區", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "存款/貸款屬於產品劃分；港島/九龍屬於地區劃分。" },
            { id: 202013, year: "2020", topic: "Accounting Cycle", question: "下列哪項有關會計循環流程的描述是正確的？", options: ["只有 (1)", "只有 (3)", "只有 (1) 及 (2)", "只有 (2) 及 (3)"], answer: 1, explanation: "(1) 期末調整應在編製試算表之後；(2) 試算表後需先作調整才編財務報表。只有 (3) 描述正確。" },
            { id: 202014, year: "2020", topic: "Accounting", question: "賺取利息收益 $8,000 對毛利和淨利的影響？", options: ["不變（毛利）、增加（淨利）", "增加（毛利）、不變（淨利）", "不變（毛利）、不變（淨利）", "增加（毛利）、增加（淨利）"], answer: 0, explanation: "利息收益屬於「其他收益」，不影響銷售成本或毛利，但會增加淨利。" },
            { id: 202015, year: "2020", topic: "Financial Market", question: "撇除其他因素，下列哪項會導致一家上市航空公司的股價下跌？\n(1) 利率上升 (2) 燃油價格上升 (3) 發出盈利警告", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "利率升增加成本，油價升增加航空成本，盈警直接打擊股價。三者皆會導致股價下跌。" },
            { id: 202016, year: "2020", topic: "Forms of Business Ownership", question: "合夥人甲（不承債/不出資/不營運）；合夥人乙（承債/出資/不營運）。其類型為：", options: ["名義合夥人、有限合夥人", "名義合夥人、普通合夥人", "普通合夥人、有限合夥人", "有限合夥人、名義合夥人"], answer: 0, explanation: "名義合夥人只借出名聲；普通合夥人需承擔無限債務責任（即使不營運）。根據答案鍵，此題選A。" },
            { id: 202017, year: "2020", topic: "Management Principles", question: "下列哪項有關權力和責任的陳述是正確的？\n(1) 權責平衡 (2) 由低層至高層遞增 (3) 授權下放權力和責任", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "這是組織架構中權責的基本原則。" },
            { id: 202018, year: "2020", topic: "Accounting", question: "下列哪項交易應記錄在超級市場的購貨帳？\n(1) 買冰箱 (2) 東主取貨自用 (3) 大量採購折扣", options: ["只有 (1)", "只有 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "只有購作轉售的貨品才計入購貨。東主提用貨品會減少購貨 (2)；冰箱是固定資產 (1)；交易折扣不入帳 (3)。" },
            { id: 202019, year: "2020", topic: "Finance", question: "下列哪些是債券投資者的權利？\n(1) 若顧問不當可投訴 (2) 可查詢建議理念 (3) 冷靜期可取消", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "投資者有知情權和投訴權。並非所有債券投資都具備法定的「冷靜期」。" },
            { id: 202020, year: "2020", topic: "Accounting Principles", question: "東主把兩家商號的購貨記入同一帳冊，違反了哪項？", options: ["應計觀念", "歷史成本", "繼續經營", "企業個體"], answer: 3, explanation: "企業個體原則要求將不同的商業實體及東主的個人帳目分開。" },
            { id: 202021, year: "2020", topic: "Business Functions", question: "下列哪項陳述是不正確的？", options: ["人力資源部招聘會計文員", "資訊管理部訂定產品價格", "風險管理部評估機器風險", "財務部為營運部取得貸款"], answer: 1, explanation: "訂定價格通常是市場營銷部門 (Marketing) 或管理層的職責，而非資訊管理部。" },
            { id: 202022, year: "2020", topic: "Social Responsibility", question: "下列哪一家公司並沒有向持份者履行社會責任？", options: ["採取嚴格信貸政策", "沒有派發股息", "產品價格較高", "沒有為僱員提供培訓"], answer: 3, explanation: "提供培訓與發展是公司對持份者（僱員）的基本社會責任之一。" },
            { id: 202023, year: "2020", topic: "Accounting Ratios", question: "計算速動比率（銀行27,000 + 應收16,400 + 短期貸款8,000）/ 應付30,800。", options: ["1.12:1", "1.57:1", "1.67:1", "2.24:1"], answer: 2, explanation: "速動資產 = 27,000 + 16,400 + 8,000 = 51,400。 51,400 / 30,800 = 1.668... 趨向 1.67:1。" },
            { id: 202024, year: "2020", topic: "Business Environment", question: "下列哪項是全球一體化對香港企業的好處？\n(1) 更多資金來源 (2) 引入新技術 (3) 較低生產成本", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "全球化允許企業在海外融資、外判生產以降低成本並學習外國技術。" },
            { id: 202025, year: "2020", topic: "Business Environment", question: "下列哪項有關強積金制度的陳述是正確的？\n(1) 僱員可每年一次轉移累算權益 (2) ... (3) ...", options: ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "根據強積金半自由行，僱員可每年一次轉移僱員供款部分的權益。" },
            { id: 202026, year: "2020", topic: "Management", question: "甲公司扁平式架構，乙公司高架式架構。下列哪項正確？", options: ["甲公司較迅速回應市場轉變。", "甲公司的管理層級較多。", "甲公司的管理人員較多。", "以上皆非"], answer: 0, explanation: "扁平式架構層級少，溝通快，決策更迅速。" },
            { id: 202027, year: "2020", topic: "Forms of Business Ownership", question: "下列哪項有關跨國公司的陳述是正確的？", options: ["跨國公司是公眾有限公司。", "跨國公司在不同國家營運。", "本地公司在海外籌資便成為跨國公司。", "以上皆是"], answer: 1, explanation: "跨國公司的定義是在多於一個國家擁有生產或辦公設施並進行營運。" },
            { id: 202028, year: "2020", topic: "Financial Market", question: "下列哪項有關主板及 GEM 的描述是正確的？\n(1) 主板公司數目較多 (2) 主板要求管理層維持不變 (3) 主板為穩健公司設", options: ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "這是香港交易所主板的基本特徵及上市要求。" },
            { id: 202029, year: "2020", topic: "Management", question: "下列哪些情況應採用自由放任式領導？\n(1) 工作要求高階創意 (2) ... (3) ...", options: ["只有 (1)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "自由放任式適合用於高度專業且需要個人創意的團隊。" },
            { id: 202030, year: "2020", topic: "Accounting", question: "天明於 4 月 21 日清還貨欠（4月8日賒購 $60,000，扣2%交易折扣，10天內再享3%）。他須償還：", options: ["57 036", "58 200", "58 800", "60 000"], answer: 2, explanation: "交易價格 = 60,000 * 0.98 = 58,800。付款日期 4月21日已過10天期限（4月18日止），故無現金折扣。須付 58,800。" }
        
			// --- 2019 年 ---
			{ id: 201901, year: "2019", topic: "Forms of Business Ownership", question: "下列哪項是獨資與普通合夥的分別？\n(1) 決策過程：獨資（較短）、普通合夥（較長）\n(2) 利得稅率：獨資（較低）、普通合夥（較高）\n(3) 債務責任：獨資（無限）、普通合夥（有限）", "options": ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "獨資由一人決定，故決策較快 (1對)；兩者目前在香港的利得稅率相同 (2錯)；兩者皆須承擔無限債務責任 (3錯)。" },
			{ id: 201902, year: "2019", topic: "Accounting Principles", question: "根據會計假設、原則及慣例，下列哪項會計處理是正確的？", "options": ["某獨資東主將其個人的租金費用記錄在商號的帳冊內。", "陳先生擁有三家商號，他為每家商號保存個別的會計記錄。", "如果預期企業將於下月停止營運，所有資產均按現時市場價格計值。", "除非新方法可以帶來更高利潤，否則已採用的會計方法不應改變。"], answer: 1, explanation: "根據「企業個體」假設，不同商號應分開記錄 (B對)；東主私人開支不應計入商號 (A錯)；若企業將結業，應按變現價值計值，但 C 的敘述不完整且 B 更準確；會計方法改變應是為了提供更真實公平的財務狀況，而非利潤 (D錯)。" },
			{ id: 201903, year: "2019", topic: "Management", question: "下列哪項有關「目標管理」(MBO) 的陳述是正確的？\n(1) 它可提升員工士氣。\n(2) 它可促進上司與下屬的溝通。\n(3) 它讓上司專注較重要的工作。", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "MBO 透過參與式目標設定提升士氣與溝通 (1, 2對)；讓上司專注重要工作主要是「例外管理」的特點 (3略有爭議，在 DSE 標準答案中通常不包含此項)。" },
			{ id: 201904, year: "2019", topic: "Accounting", question: "根據「區先生」的帳戶資料（10/1 承上結餘 $10,000 貸方；10/5 購貨 $56,000 貸方；10/14 現金 $22,000 借方；10/31 結轉下 $44,000 借方），下列哪項不正確？", "options": ["2018 年 10 月 1 日李氏商號欠區先生 $10,000。", "2018 年 10 月 5 日區先生向李氏商號賒銷貨品 $56,000。", "2018 年 10 月 14 日李氏商號從區先生收到現金 $22,000。", "2018 年 10 月 31 日這帳戶有貸方結餘。"], answer: 2, explanation: "區先生帳戶借方出現現金 $22,000，代表李氏支付現金給區先生（還債），而非收到現金。故 C 錯誤。" },
			{ id: 201905, year: "2019", topic: "Business Environment", question: "下列哪項有關香港經濟的描述是正確的？\n(1) 對貨品零售徵收銷售稅\n(2) 大多數勞動人口都是從事第三級產業\n(3) 貨品出口的主要目的地是內地", "options": ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 3, explanation: "香港沒有銷售稅 (1錯)；香港是服務導向經濟，主力第三級產業 (2對)；內地是最大出口目的地 (3對)。" },
			{ id: 201906, year: "2019", topic: "Accounting Equation", question: "商號購入 $200,000 設備。東主以私人支票支付 $50,000，餘額稍後清還。對會計等式的影響？", "options": ["資產（增加）、資本（增加）、負債（減少）", "資產（增加）、資本（增加）、負債（增加）", "資產（增加）、資本（減少）、負債（增加）", "資產（減少）、資本（不變）、負債（減少）"], answer: 1, explanation: "資產（設備）增加 $200,000；資本（東主投入）增加 $50,000；負債（應付帳款）增加 $150,000。故選 B。" },
			{ id: 201907, year: "2019", topic: "Business Functions", question: "一家公司將推出新產品，公司的財務經理負責：\n(1) 為新產品制定售價\n(2) 為推出新產品尋求資金\n(3) 為新產品編製預算", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "制定售價主要是市場營銷經理的職責 (1錯)；籌集資金 (2) 及編製財務預算 (3) 屬財務經理範疇。" },
			{ id: 201908, year: "2019", topic: "Finance", question: "貸款 $100,000，年利率 12%，每月複息。下列哪項正確？\n(1) 名義年利率為 12%\n(2) 實際年利率高於 12%\n(3) 私人貸款利率較信用卡低", "options": ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "報價利率為名義利率 (1對)；每月複息導致實際利率更高 (2對)；信用卡通常是最高息的無抵押貸款 (3對)。" },
			{ id: 201909, year: "2019", topic: "Business Ethics", question: "下列哪項有關商業道德的陳述是正確的？\n(1) 法律上可接受的行為可能是不道德的。\n(2) 「專業操守」是政府為企業編製的。\n(3) 商業道德是有明確定義的道德原則和標準。", "options": ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 0, explanation: "合規不代表合乎道德 (1對)；專業操守通常由專業團體或企業自行編製 (2錯)；道德標準往往隨社會文化改變，並非全球統一明確 (3描述過於絕對)。" },
			{ id: 201910, year: "2019", topic: "Accounting Ratios", question: "速動比率 0.8:1。結餘：存貨 6,000、銀行貸款(短期) 10,000、現金 30,000、應付貨款 50,000。應收貨款數額？", "options": ["$4,000", "$10,000", "$12,000", "$18,000"], answer: 3, explanation: "流動負債 = 10,000 + 50,000 = 60,000。速動資產 = 60,000 * 0.8 = 48,000。應收貨款 = 48,000 - 現金 30,000 = 18,000。" },
			{ id: 201911, year: "2019", topic: "Forms of Business Ownership", question: "下列哪項有關合營企業 (Joint Venture) 的陳述是正確的？\n(1) 風險共同承擔 (2) 項目完成後通常解散 (3) 由最少兩家企業組成的企業個體", "options": ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "這是合營企業的基本定義和運作特色。" },
			{ id: 201912, year: "2019", topic: "Accounting", question: "下列哪項會減少企業的流動負債總額？\n(1) 退貨給供應商 (2) 用銀行透支償還應付貨款 (3) 借三年貸款償還六個月貸款", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "退貨減少應付貨款 (1對)；銀行透支本身也是流動負債，只是債項轉移 (2錯)；將流動負債轉為非流動負債會減少流動負債總額 (3對)。" },
			{ id: 201913, year: "2019", topic: "Business Environment", question: "下列有關香港中小型企業 (SME) 的陳述是正確的？", "options": ["僱員人數佔總就業人數 80%", "它可以以有限公司營運", "全年銷售收益不可多於五百萬元"], answer: 1, explanation: "中小企可採取有限公司或獨資/合夥形式 (2對)；受僱人數佔比約 45% 而非 80% (1錯)；製造業少於 100 人，非製造業少於 50 人為定義，無銷售額限制 (3錯)。" },
			{ id: 201914, year: "2019", topic: "Accounting", question: "銷售辦公室設備的獨資商號，財務狀況表 (Balance Sheet) 陳述何者正確？", "options": ["待售的辦公室設備應分類為流動資產。", "顯示本年度交易的詳細資料。", "顯示虛帳戶和實帳戶結餘。", "營運資金是非流動資產與非流動負債的差額。"], answer: 0, explanation: "由於該商號銷售設備，該設備即為「存貨」，屬流動資產 (A對)；詳情在日記簿及分類帳 (B錯)；財務狀況表只顯示實帳戶 (C錯)；營運資金 = 流動資產 - 流動負債 (D錯)。" },
			{ id: 201915, year: "2019", topic: "Financial Market", question: "主板上市基本要求的陳述何者正確？\n(1) 營運歷史要求 (2) 必須是跨國公司 (3) 三項財務測試選其一", "options": ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "主板有營運歷史要求 (1對)；本地公司也可上市，不限跨國 (2錯)；有盈利或市值等多種測試標準 (3對)。" },
			{ id: 201916, year: "2019", topic: "Accounting", question: "銷貨 $154,000、購貨 $51,000、銷貨運費 $2,500、購貨運費 $4,700、存貨(期初) $7,200。計算毛利。", "options": ["$72,000", "$105,500", "$107,700", "$114,900"], answer: 1, explanation: "毛利 = 銷貨 - (期初存貨 + 購貨 + 購貨運費 - 期末存貨)。題目未提期末存貨，假設為 0 或為單一期間購入。計算：154,000 - (51,000 + 4,700) = 98,300。若 7,200 是期初：154,000 - (7,200 + 51,000 + 4,700) = 91,100。根據答案 B (105,500)：154,000 - (51,000 - 2,500...) 顯然計算方式是 154,000 - 51,000 + 存貨調整。此題數據可能默認購貨運費計入成本，銷貨運費不計。154,000 - (51,000 + 4,700 - 7,200) = 105,500。" },
			{ id: 201917, year: "2019", topic: "Social Responsibility", question: "下列哪項是酒店履行社會責任 (CSR) 的例子？\n(1) 惡劣天氣下讓員工在家工作 (2) 以最低工資支付員工 (3) 提供魚翅", "options": ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "關懷員工安全 (1) 屬 CSR；支付法定最低工資僅屬守法 (2)；提供魚翅涉及環保爭議，不符合 CSR 精神 (3)。" },
			{ id: 201918, year: "2019", topic: "Business Environment", question: "徐思 (35歲) 開店，聘畢玲 (30歲) 月薪 $5,000。強積金 (MPF) 陳述何者正確？", "options": ["徐思需登記強積金", "徐思需為畢玲登記並供款", "畢玲需強制性供款"], answer: 0, explanation: "自僱人士徐思需參加 (1對)；月薪 $5,000 低於最低入息水平 ($7,100)，畢玲本人不需供款，但徐思作為僱主仍需供款 5%。選項 A 為正確。" },
			{ id: 201919, year: "2019", topic: "Accounting", question: "下列哪項複式記帳是正確的？\n(1) 銷貨退回：借記銷貨、貸記應收 (2) 還貸款：借記貸款、貸記銀行 (3) 退回多付費用：借記現金、貸記汽車費用", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "三者皆符合會計原則。(1) 應是「銷貨退回」帳戶，但 DSE 常將其視為減少銷貨。" },
			{ id: 201920, year: "2019", topic: "Finance", question: "投資風險與回報陳述何者正確？\n(1) 分散行業投資可減低企業特有風險 (2) 儲蓄戶口無風險 (3) 債券回報包含增益及股息", "options": ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "分散投資可抵銷非系統風險 (1對)；任何銀行存款都有違約或通脹風險 (2錯)；債券回報是利息 (Interest) 而非股息 (Dividend) (3錯)。" },
			{ id: 201921, year: "2019", topic: "Business Environment", question: "下列有關企業家的陳述是正確的？\n(1) 接受挑戰 (2) 創造就業 (3) 引入新產品促進競爭", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "三者皆為企業家的特質及對經濟的貢獻。" },
			{ id: 201922, year: "2019", topic: "Business Environment", question: "下列有關世界貿易組織 (WTO) 的陳述是正確的？\n(1) 調解貿易糾紛 (2) 談判平台 (3) 提供發展中國家財政支援", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "WTO 負責糾紛與談判 (1, 2對)；提供財政支援主要是世界銀行或國際貨幣基金組織的職責 (3錯)。" },
			{ id: 201923, year: "2019", topic: "Accounting Cycle", question: "會計循環中，過帳至分類帳後，下一個步驟是：", "options": ["編製財務報表", "把交易記錄在原始分錄帳簿", "編製試算表", "作出期末調整"], answer: 2, explanation: "會計循環順序：原始分錄 -> 分類帳過帳 -> 試算表 (C) -> 期末調整 -> 財務報表。" },
			{ id: 201924, year: "2019", topic: "Financial Market", question: "下列哪項有關恆生指數的陳述是正確的？", "options": ["由 60 隻成分股組成。", "所有成分股均在主板上市。", "反映亞太區股票市場表現。", "「資訊科技」是四個分類指數之一。"], answer: 1, explanation: "成分股數目會變動 (目前超過 80 隻) (A錯)；僅限主板公司 (B對)；僅反映香港市場 (C錯)；分類指數是金融、地產、公用、工商 (D錯)。" },
			{ id: 201925, year: "2019", topic: "Accounting", question: "下列哪項不是財務報表對相關用家的主要用途？", "options": ["僱員：評估公司前景", "管理人員：評估財務表現", "政府：計算利得稅額", "顧客：評估公司的變現能力"], answer: 3, explanation: "變現能力 (Liquidity) 對債權人很重要，對一般顧客而言，他們更關心持續經營能力而非變現能力。故 D 最不相關。" },
			{ id: 201926, year: "2019", topic: "Finance", question: "下列有關信用卡的陳述是正確的？\n(1) 預批信用限額 (2) 繳款期限 (3) 每月最低還款額", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "三者皆為信用卡的基本運作機制。" },
			{ id: 201927, year: "2019", topic: "Management Functions", question: "一名經理將員工的實際表現與表現標準比較，這工作屬於：", "options": ["領導", "組織", "計劃", "控制"], answer: 3, explanation: "衡量實際表現並與標準對比，以便糾正偏差，這是「控制」(Controlling) 的定義。" },
			{ id: 201928, year: "2019", topic: "Accounting", question: "根據數據計算 1 月 1 日的期初資本。購貨 74k、存貨(期末) 6.2k、銀行 121.5k、貸款 36.7k、設備 15k、銷貨 123k、費用 28k、提用 14.7k。", "options": ["$43,700", "$70,300", "$99,700", "$197,700"], answer: 2, explanation: "根據會計等式：資產 = 負債 + 資本。期末資本 = 121.5k + 6.2k + 15k - 36.7k = 106k。期末資本 = 期初資本 + 淨利 - 提用。淨利 = 123k - 74k - 28k = 21k。期初資本 = 106k - 21k + 14.7k = 99.7k。" },
			{ id: 201929, year: "2019", topic: "Finance", question: "每年存入 $3,000，利率 1%。2019, 2020, 2021 四月各存一次。2022 年三月底餘額？", "options": ["$3,091", "$9,090", "$9,181", "$9,273"], answer: 3, explanation: "這是年金終值計算。第一筆：3,000 * (1.01)^3；第二筆：3,000 * (1.01)^2；第三筆：3,000 * (1.01)^1。總額 = 3090.9 + 3060.3 + 3030 = 9181.2。若存四次 (2019, 20, 21, 22)? 不，2022年4月1日在結算日之後。應為 3000 * [(1.01^3 - 1)/0.01] * 1.01 ≈ 9273。" },
			{ id: 201930, year: "2019", topic: "Management Principles", question: "根據組織圖（總經理 -> 3位經理 -> 每位經理下2位主任），陳述何者正確？\n(1) 按功能劃分部門 (2) 總經理控制幅度是九 (3) 總經理對市場營銷經理有直線職權", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "市場、會計、人事是功能部門 (1對)；控制幅度僅指直接下屬人數，即 3 人 (2錯)；直接上下級關係屬直線職權 (3對)。" }
			
			// --- 2018 年 ---
			{ id: 201801, year: "2018", topic: "Business Environment", question: "下列哪項有關香港經濟的陳述是不正確的？", "options": ["香港政府不會操控資本進出。", "香港是世界貿易組織的創始成員。", "香港的企業大多是跨國公司。", "在 CEPA 下，香港服務提供者可以優惠待遇在內地開展業務。"], answer: 2, explanation: "香港經濟以中小型企業 (SMEs) 為主，佔全港企業總數 98% 以上，並非大多是跨國公司。" }
			{ id: 201802, year: "2018", topic: "Accounting", question: "下列哪個帳戶必定在試算表出現借方結餘？", "options": ["租金收益", "購貨退出", "購貨折扣", "貸款予員工"], answer: 3, explanation: "「貸款予員工」屬於商號的資產（債權），資產類帳戶在正常情況下為借方結餘。其餘三項：收益、購貨退出（減少成本）、購貨折扣（減少成本）均為貸方項目。" }
			{ id: 201803, year: "2018", topic: "Financial Market", question: "如果在過去一個月，恆生指數上升了 10%，這表示過去一個月：\n(1) 「恆生工工商業分類指數」上升了 10%\n(2) 恆生指數成份股的成交金額上升了 10%\n(3) 恆生指數成份股的市價普遍上升了", "options": ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (2) 及 (3)"], answer: 2, explanation: "恆指是反映成份股市值的加權平均指標。指數上升 10% 代表成份股股價普遍上升，但不代表特定分類指數或成交量也精確上升 10%。" }
			{ id: 201804, year: "2018", topic: "Accounting", question: "下列哪項複式記帳是正確的？\n(1) 收到銀行存款利息：借記「利息收益」、貸記「銀行存款」\n(2) 賒購辦公室用的文具：借記「文具費用」、貸記「應付帳款」\n(3) 東主引入他的汽車供商號使用：借記「汽車」、貸記「提用」", "options": ["只有 (1)", "只有 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "(1) 應為借銀行、貸收益；(3) 應為借汽車、貸資本（東主引入資產是資本增加）。只有 (2) 正確。" }
			{ id: 201805, year: "2018", topic: "Management Functions", question: "品質控制步驟的次序應為：\n(1) 抽樣量度實際次貨率 (2) 採取跟進措施 (3) 訂立可接受的次貨率 (4) 比較實際與可接受的次貨率", "options": ["(1) → (3) → (2) → (4)", "(1) → (4) → (3) → (2)", "(3) → (1) → (2) → (4)", "(3) → (1) → (4) → (2)"], answer: 3, explanation: "控制功能的標準程序：設定標準 (3) → 衡量表現 (1) → 比較 (4) → 採取糾正行動 (2)。" }
			{ id: 201806, year: "2018", topic: "Accounting Principles", explanation: "根據「企業個體」原則，只有與業務相關的開支才計入商號費用。(1) 工資是業務開支；(3) 雖然是東主私下支付，但屬於商號租金（會計處理為借租金、貸資本）。(2) 屬提用，非公司費用。", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, question: "下列哪項應記作商號的費用？\n(1) 以現金支付商號兼職工人的工資\n(2) 以商號支票支付東主私人住宅保險費\n(3) 以東主個人支票支付商號貨倉租金" }
			{ id: 201807, year: "2018", topic: "Business Ethics", question: "符合商業道德的行為：\n(1) 可提升企業的公眾形象。\n(2) 長遠來說會增加企業的營運成本。\n(3) 讓企業以較低利得稅率納稅。", "options": ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 0, explanation: "良好的商業道德能提升形象及品牌價值。它不一定增加成本（反而可能減少訴訟或員工流失成本），也與稅率高低無關。" }
			{ id: 201808, year: "2018", topic: "Accounting", question: "下列哪項應貸記商號的購貨帳？\n(1) 東主提取貨物自用\n(2) 退回貨物予供應商\n(3) 捐贈貨物予非牟利機構", "options": ["只有 (1)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "提取自用 (1) 及捐贈 (3) 會使可供銷售貨品減少，故貸記購貨帳。(2) 退回供應商應貸記專門的「購貨退出」帳戶。" }
			{ id: 201809, year: "2018", topic: "Business Functions", question: "下列哪項是公司市場營銷部門的主要功能？\n(1) 策劃市場研究 (2) 制定貨物價格策略 (3) 控制貨物品質", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "市場營銷負責 4P（產品、價格、渠道、促銷）及研究。品質控制 (3) 通常由生產或營運部門負責。" }
			{ id: 201810, year: "2018", topic: "Accounting", question: "下列哪個是實帳戶 (Real Account) 的例子？\n(1) 銷貨帳 (2) 銀行貸款帳 (3) 設備帳", "options": ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (2) 及 (3)"], answer: 3, explanation: "實帳戶指資產、負債及資本帳戶。設備是資產，銀行貸款是負債。銷貨是虛帳戶（收益類），期末需結轉損益帳。" }
			{ id: 201811, year: "2018", topic: "Management Principles", question: "一家貿易商號按功能劃分部門，總經理與部門經理商討並定時檢視目標達成情況。應用了哪項？", "options": ["(1) 及 (2)", "(1) 及 (3)", "(2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "與經理商討並檢視目標符合「目標管理」(MBO)；按功能設部門符合「部門化」。" }
			{ id: 201812, year: "2018", topic: "Accounting", question: "計算 3 月末銀行存款結餘：初 15,000，存入現銷 (13,000-5,000) = 8,000，設備支出 26,000。", "options": ["貸方結餘 $3,000", "貸方結餘 $6,000", "借方結餘 $5,000", "借方結餘 $8,000"], answer: 0, explanation: "銀行結餘 = 15,000 + 8,000 - 26,000 = -3,000。銀行帳戶負數代表銀行透支，即貸方結餘 $3,000。" }
			{ id: 201813, year: "2018", topic: "Finance", question: "下列哪項有關銀行透支的陳述是正確的？\n(1) 沒有固定還款期 (2) 利息通常按月計算 (3) 通常毋須抵押", "options": ["只有 (1)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "透支利息通常按日計算 (2 錯)。它具備靈活性且通常是無抵押的短期融資。" }
			{ id: 201814, year: "2018", topic: "Social Responsibility", question: "就一家玩具公司而言，下列哪項不是履行社會責任的例子？", "options": ["使用回收材料製造玩具", "捐贈玩具予孤兒院", "聖誕期間給予顧客 20% 折扣", "改善員工工作環境"], answer: 2, explanation: "打折促銷屬於商業市場策略，旨在增加銷售利潤，不屬於社會責任 (CSR) 範疇。" }
			{ id: 201815, year: "2018", topic: "Finance", question: "車價三年後為 $500,000 * (1.03)^3 = $546,363.5。現需投資多少 (回報 5%) 以達成？", "options": ["$471,969", "$490,476", "$509,709", "$529,695"], answer: 0, explanation: "計算：$546,363.5 / (1.05)^3 = 471,969。這結合了未來價值與現值的觀念。" }
			{ id: 201816, year: "2018", topic: "Management", question: "下列哪項是企業採用目標管理 (MBO) 的好處？\n(1) 增強下屬的工作滿足感 (2) 降低行政成本 (3) 減少工作延誤", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "MBO 讓員工參與決策提升滿足感，並透過明確時限減少延誤。但協商與監控過程往往會增加行政成本。" }
			{ id: 201817, year: "2018", topic: "Accounting", question: "初資本 443,800，末 425,000。淨損 = 108,500 - 97,000 = 11,500。計算變動。", "options": ["從商號提用 $7,300", "從商號提用 $30,300", "注資商號 $7,300", "注資商號 $30,300"], answer: 1, explanation: "期末資本 = 期初資本 - 淨損 - 提用 + 注資。425,000 = 443,800 - 11,500 - 提用。提用 = 7,300。根據官方答案，此題答案為 B ($30,300)，可能涉及隱含數據，請依 ANS 鍵 B 為準。" }
			{ id: 201818, year: "2018", topic: "Forms of Business Ownership", question: "海洋公園公司是香港一家公營公司，下列哪項陳述是正確的？", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "公營公司 (Public Corporation) 由政府擁有及提供公共服務 (1, 2 對)。它不一定必須在證券交易所上市 (3 錯)。" }
			{ id: 201819, year: "2018", topic: "Finance", question: "計算投資機器的淨現值 (NPV)，需要下列哪項資料？\n(1) 最初成本 (2) 殘值 (3) 使用年限", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "NPV 計算需要所有預期現金流（含成本、年限內的收入、期末殘值）及貼現率。" }
			{ id: 201820, year: "2018", topic: "Accounting", question: "下列哪項會增加一家貿易商號的毛利？", "options": ["購貨退出減少", "銷貨運費減少", "供應商提高交易折扣", "供應商提高現金折扣"], answer: 2, explanation: "交易折扣直接降低購貨成本，從而增加毛利。銷貨運費屬營運費用，不影響毛利；現金折扣屬財務損益。" }
			{ id: 201821, year: "2018", topic: "Accounting Ratios", question: "計算兩家公司的流動資產組成。明記 (6:1 vs 2:1) 與 陳記 (2.5:1 vs 1.5:1)。", "options": ["(1) 及 (2)", "(1) 及 (3)", "(2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "明記的存貨佔比 (6-2=4) 明顯高於陳記 (2.5-1.5=1)。這代表明記的存貨積壓風險較大。" }
			{ id: 201822, year: "2018", topic: "Financial Market", question: "在創業板 (GEM) 對新申請人的基本上市要求中，並沒有就下列哪項設有最低要求？", "options": ["現金流", "盈利", "營業紀錄", "市值"], answer: 1, explanation: "GEM 設立初衷是為了具備增長潛力但未必有盈利紀錄的公司，因此不設最低盈利要求（相對於主板）。" }
			{ id: 201823, year: "2018", topic: "Accounting", question: "下列哪項不是會計的功能？", "options": ["歸納企業交易", "監控會計人員的表現", "向持份者傳遞資訊", "把交易分類"], answer: 1, explanation: "監控人員表現屬於人力資源或一般管理的「控制」功能，會計本身的功能在於記錄、分類、歸納及報告財務數據。" }
			{ id: 201824, year: "2018", topic: "Forms of Business Ownership", question: "下列哪項有關合夥的陳述是正確的？", "options": ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "普通合夥所有合夥人均承擔無限責任 (1 對)。若有合夥人承擔有限責任，則稱為有限合夥。" }
			{ id: 201825, year: "2018", topic: "Finance", question: "下列哪項有關風險和回報的陳述是正確的？", "options": ["市場風險是可以分散的。", "高風險金融產品必有高回報。", "投資者喜歡投資債券多於定存。", "保守人士喜歡投資債券多於股票。"], answer: 3, explanation: "市場風險（系統風險）不可分散 (A 錯)；高風險不保證高回報 (B 錯)；債券波動性低於股票，適合保守人士 (D 正確)。" }
			{ id: 201826, year: "2018", topic: "Management", question: "目標：「在 2019 年，有 50% 香港駕駛人士會購買我們的新款汽車。」符合哪項 SMART 準則？", "options": ["只有 (2)", "只有 (3)", "只有 (1) 及 (2)", "只有 (1) 及 (3)"], answer: 2, explanation: "具備時限 (2019年) 及可衡量 (50%)。但這目標對單一廠商而言顯然極不切實際 (Attainable)，故不完全符合 SMART。" }
			{ id: 201827, year: "2018", topic: "Management", question: "以下哪項有關「職權」的陳述是正確？", "options": ["只有 (2)", "只有 (3)", "只有 (1) 及 (2)", "(1)、(2) 及 (3)"], answer: 1, explanation: "直線職權是指上司直接指揮下屬的權力 (3 正確)。" }
			{ id: 201828, year: "2018", topic: "Forms of Business Ownership", question: "與公眾有限公司比較，下列哪項是私人有限公司的優點？", "options": ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (1) 及 (2)"], answer: 0, explanation: "私人有限公司不需向公眾披露詳盡財務報表，受到的政府監管及法律披露要求較少。" }
			{ id: 201829, year: "2018", topic: "Accounting", question: "下列哪項有關損益表的陳述是不正確的？", "options": ["資料大多是量化的。", "資料主要反映過去事項。", "其編製需要專業判斷。", "其編製只根據現金收入和支出。"], answer: 3, explanation: "會計採用「應計觀念」(Accrual Basis)，損益表反映的是該期間賺取的收益與發生的費用，而非單純的現金收支。" }
			{ id: 201830, year: "2018", topic: "Personal Finance", question: "下列哪項有關強積金 (MPF) 制度的陳述是正確的？", "options": ["16 至 65 歲自僱人士須參加。", "建造業工人可豁免。", "失業超兩年可提早提取。", "轉職時可轉移累算權益。"], answer: 3, explanation: "年齡應為 18 至 65 歲 (A 錯)；建造業屬臨時人員亦需參加 (B 錯)；失業不能提早提取 (C 錯)；僱員可將權益轉至新受託人 (D 正確)。" }	
		
			// --- 2017 年 ---
			{ id: 201701, year: "2017", topic: "Business Environment", question: "下列哪項有關亞太區經濟合作組織（APEC）的陳述是正確的？\n(1) 它排解亞太地區的貿易糾紛。\n(2) 它促進亞太地區的可持續經濟增長。\n(3) 它透過政府與政府之間的高層對話，鼓勵亞太地區在貿易和投資方面的合作。", "options": ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "APEC 主要是一個非正式的論壇，旨在促進增長與合作 (2, 3對)；排解貿易糾紛是世界貿易組織 (WTO) 的功能，而非 APEC (1錯)。" }
			{ id: 201702, year: "2017", topic: "Accounting", question: "假設一個試算表沒有遺漏帳戶結餘，而試算表的借方結餘總和與貸方結餘總和不相等，這表示 ___________。\n(1) 試算表內有一項或多項帳戶結餘出錯\n(2) 財務狀況表將不會平衡\n(3) 損益表內的淨利將會是錯誤的", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "借貸不平代表錄入或加總有誤 (1對)；試算表不平，後續的財務狀況表必然無法平衡 (2對)。淨利未必一定錯誤（若錯誤僅發生在實帳戶），但在 DSE 邏輯中 A 為最佳選擇。" }
			{ id: 201703, year: "2017", topic: "Financial Market", question: "下列哪項有關恆生指數的陳述是不正確的？", "options": ["它的分類指數有：金融、公用事業、地產和工商業。", "它量度香港市值最大和成交最活躍的上市公司的表現。", "它包括 50 隻在創業板上市的股票。", "它是香港股票市場整體表現的指標。"], answer: 2, explanation: "恆生指數的成分股均是在「主板」上市，不包括「創業板」(GEM) 的股票。" }
			{ id: 201704, year: "2017", topic: "Management Principles", question: "下列哪項有關企業管理的陳述是正確? \n(1) 統一命令原則下，每名下屬只聽命於一名上司。\n(2) 高架式架構層級較扁平式架構多。\n(3) 目標管理可改善上司下屬溝通。", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "這三項皆為管理學的基本原則：統一命令 (Unity of Command)、架構層級差異以及 MBO 的好處。" }
			{ id: 201705, year: "2017", topic: "Accounting Cycle", question: "在會計循環中，下列哪個步驟緊隨編製試算表之後？", "options": ["編製財務報表", "作出期末調整", "過帳至分類帳", "於原始分錄簿記錄交易"], answer: 1, explanation: "標準會計循環：原始分錄 → 分類帳 → 試算表 → 期末調整 (B) → 財務報表。" }
			{ id: 201706, year: "2017", topic: "Business Environment", question: "下列哪項有關香港與內地貿易關係的陳述是正確的？\n(1) 香港是內地最大的貿易夥伴。\n(2) 內地是香港最大的轉口目的地。\n(3) 很多香港原產地貨物出口到內地免關稅。", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "內地的最大貿易夥伴通常是美國或歐盟，而非香港 (1錯)；內地是香港最大轉口市場及 CEPA 協議下免關稅 (2, 3對)。" }
			{ id: 201707, year: "2017", topic: "Business Environment", question: "江娜 62 歲，月薪 $40,000。在強積金 (MPF) 制度下，每月供款多少？", "options": ["$4,000", "$2,000", "$1,500", "$0"], answer: 2, explanation: "強積金供款上限為月薪 $30,000 的 5%，即 $1,500。年齡 62 歲仍未滿 65 歲強制提現年齡，仍須供款。" }
			{ id: 201708, year: "2017", topic: "Business Functions", question: "下列哪項是公司資訊管理部門的工作？\n(1) 設計檔案儲存系統 (2) 協助處理市場研究數據 (3) 為財務部門編製預算", "options": ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "資訊管理部負責系統設計與數據處理支援 (1, 2對)；編製預算 (3) 屬財務部本身的職能。" }
			{ id: 201709, year: "2017", topic: "Accounting", question: "如一帳戶有借方結餘，下列哪項陳述是正確的？", "options": ["帳戶借方入帳總額較貸方高。", "結餘轉下在帳戶的借方出現。", "承上結餘在帳戶的右方出現。", "這帳戶是資產帳戶。"], answer: 0, explanation: "借方結餘 (Debit Balance) 的定義即為左方總額大於右方總額 (A對)。結餘轉下應在貸方 (B錯)，承上結餘應在左方 (C錯)；費用帳戶也有借方結餘 (D不一定)。" }
			{ id: 201710, year: "2017", topic: "Finance", question: "利率每年複式 7%。三年後收回 $150,000，現在應存入多少？", "options": ["$120,654", "$122,445", "$131,016", "$183,756"], answer: 1, explanation: "計算現值 (PV)：$PV = 150,000 / (1 + 0.07)^3 = 150,000 / 1.225043 = 122,445$。" }
			{ id: 201711, year: "2017", topic: "Forms of Business Ownership", question: "與獨資比較，下列哪項是有限公司的優點？\n(1) 企業具延續性 (2) 成立成本較低 (3) 利得稅稅率較低", "options": ["只有 (1)", "只有 (1) 及 (2)", "只有 (1) 及 (3)", "(2) 及 (3)"], answer: 0, explanation: "有限公司具獨立法人地位，不因東主離世而結束 (1對)；其成立程序複雜，成本較獨資高 (2錯)；香港有限公司利得稅率通常高於獨資 (3錯)。" }
			{ id: 201712, year: "2017", topic: "Accounting Ratios", question: "陳記：毛利率 39%、淨利率 24%；葉記：毛利率 45%、淨利率 20%。結論是：", "options": ["葉記的銷售額較高。", "葉記的銷貨成本較高。", "陳記的淨利較高。", "陳記控制營運費用的表現較佳。"], answer: 3, explanation: "陳記毛利率低但淨利率高，說明營運費用 (Expenses) 佔比較少，控制費用表現較佳。" }
			{ id: 201713, year: "2017", topic: "Finance", question: "如名義回報率不變，下列哪項正確？\n(1) 實際回報率反映真實回報 (2) 本金增加，實際回報率上升 (3) 複息頻率增加，實際回報率上升", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "實際回報率扣除通脹影響 (1對)；複息頻率增加會提升實際年利率 (3對)；利率與本金金額無關 (2錯)。" }
			{ id: 201714, year: "2017", topic: "Business Environment", question: "下列哪項展示企業家精神對商業發展的重要？\n(1) 減少企業風險 (2) 促進經濟增長 (3) 鼓勵創新", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 2, explanation: "企業家精神推動創新與經濟 (2, 3對)；企業家通常需要承擔風險而非減少風險 (1錯)。" }
			{ id: 201715, year: "2017", topic: "Accounting", question: "下列哪項不是財務報表的用途？", "options": ["協助不同用家作決策", "提供有關企業財政狀況的資訊", "為員工提供評估工作保障的資訊", "提供有關企業表現的質性資訊"], answer: 3, explanation: "財務報表主要提供「量化」(Quantitative) 的貨幣資訊，而非「質性」(Qualitative) 資訊。" }
			{ id: 201716, year: "2017", topic: "Business Environment", question: "下列哪些是影響香港企業的自然地理因素？\n(1) 氣候條件 (2) 空氣質素 (3) 人口結構", "options": ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "氣候與環境屬自然地理因素 (1, 2對)；人口結構屬社會文化因素 (3錯)。" }
			{ id: 201717, year: "2017", topic: "Financial Market", question: "除哪項外，都是主板上市的基本要求？", "options": ["員工規模", "現金流量", "營業記錄", "股東應佔盈利"], answer: 0, explanation: "主板上市對財務（盈利/現金流/市值）及營業記錄有要求，但並無最低「員工規模」要求。" }
			{ id: 201718, year: "2017", topic: "Forms of Business Ownership", question: "對特許權擁有人 (Franchisor) 而言，特許經營缺點？\n(1) 使用人可能變競爭者 (2) 難完全控制經營 (3) 個別經營不善損商譽", "options": ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "這三項都是特許經營模式中擁有人需面對的典型風險。" }
			{ id: 201719, year: "2017", topic: "Accounting Equation", question: "汽車 $40k，親戚借 $200k，銀行借 $100k。資產、負債及資本是多少？", "options": ["資產 $240,000；負債 $200,000；資本 $40,000", "資產 $40,000；負債 $300,000；資本 $340,000", "資產 $340,000；負債 $100,000；資本 $240,000", "資產 $340,000；負債 $300,000；資本 $40,000"], answer: 3, explanation: "資產 = 汽車 40k + 設備 200k + 銀行 100k = 340k；負債 = 借款 200k + 100k = 300k；資本 = 340k - 300k = 40k。" }
			{ id: 201720, year: "2017", topic: "Business Environment", question: "下列哪項有關香港中小型企業（中小企）的陳述是正確的？\n(1) 香港大多數企業都是中小企。\n(2) 中小企若非獨資便是合夥。\n(3) 中小企通常由東主管理。", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "中小企佔香港企業 98% (1對)；中小企也可以是私人有限公司 (2錯)；多由東主直接打理 (3對)。" }
			{ id: 201721, year: "2017", topic: "Accounting Ratios", question: "計算速動比率：銀行 18k、現金 58k、應收 162k、應付 86k。", "options": ["1.16 : 1", "2.77 : 1", "3.59 : 1", "6.02 : 1"], answer: 1, explanation: "速動資產 = 18k + 58k + 162k = 238k。速動比率 = 238,000 / 86,000 = 2.767..." }
			{ id: 201722, year: "2017", topic: "Accounting", question: "計算營運資金：流動資產 (18+58+71+162) - 流動負債 (86)。", "options": ["$103,000", "$152,000", "$223,000", "$503,000"], answer: 2, explanation: "流動資產 = 309,000。營運資金 = 309,000 - 86,000 = 223,000。" }
			{ id: 201723, year: "2017", topic: "Personal Finance", question: "維持良好個人信貸紀錄的好處？\n(1) 貸款利率較低 (2) 信貸額較高 (3) 定存獲取較佳條款", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "信貸紀錄影響借貸成本 (1, 2對)；定存是銀行欠客戶錢，條款主要看市場利率而非客戶信用 (3錯)。" }
			{ id: 201724, year: "2017", topic: "Management Principles", question: "下列哪項有關「統一的方向」(Unity of Direction) 的陳述是正確的？", "options": ["每名主管每次只負責一個項目。", "每名員工於每一時段只朝一個目標工作。", "為同一項目工作的員工都有相同目標。", "企業的目標應在合理的時段內完成。"], answer: 2, explanation: "統一的方向是指：凡是目標相同的各項活動，都應有一個領導者和一套計劃。" }
			{ id: 201725, year: "2017", topic: "Accounting Principles", question: "下列哪項會計假設、原則描述正確？", "options": ["歷史成本：所有交易都應記錄", "企業個體：東主可記個人開支", "一貫性：政策不可更改", "繼續經營：企業持續營運"], answer: 3, explanation: "繼續經營 (Going Concern) 指預期企業會無限期運作 (D對)；一貫性指不應無故更改，而非絕對不可 (C錯)。" }
			{ id: 201726, year: "2017", topic: "Financial Market", question: "下列哪項會影響銷售汽車的上市公司的股價？\n(1) 燃油價格 (2) 利率 (3) 公司的派息政策", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "油價影響用車成本，利率影響借貸買車及融資成本，派息影響投資者吸引力，三者皆有影響。" }
			{ id: 201727, year: "2017", topic: "Management", question: "下列哪項不是企業採用民主式領導的優點？", "options": ["提高營運效率", "擴闊管理人員的視野", "加強員工支持", "促進相互了解"], answer: 0, explanation: "民主式領導因需要協商，決策速度及營運效率通常比獨裁式低。" }
			{ id: 201728, year: "2017", topic: "Accounting", question: "下列哪項複式記帳是正確的？\n(1) 支票還債：借應付、貸銀行 (2) 賒銷傢具：借應收、貸銷貨 (3) 支付銷貨運費：借銷貨運費、貸現金", "options": ["只有 (1)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "(2) 錯在貸方應為「辦公室傢具」而非「銷貨」（只有賣貨物才用銷貨）。(1, 3) 正確。" }
			{ id: 201729, year: "2017", topic: "Accounting", question: "下列哪項有關會計比率的陳述是正確的？", "options": ["評估企業財務業績", "分析不同商號表現", "分析趨勢"], answer: 3, explanation: "會計比率的三大主要用途：評估業績、商號比較、趨勢分析。" }
			{ id: 201730, year: "2017", topic: "Forms of Business Ownership", question: "下列哪項有關名義合夥人 (Nominal Partner) 的陳述是正確的？\n(1) 承擔債務 (2) 參與運作 (3) 聲譽助推廣", "options": ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (1) 及 (3)"], answer: 3, explanation: "名義合夥人通常不參與運作 (2錯)，但因對外掛名，仍須承擔無限債務責任 (1對)，其目的通常是利用其聲望 (3對)。" }
		
			// --- 2016 年 ---
		    { id: 201601, year: "2016", topic: "Business Environment", question: "下列哪項是位於香港的跨國公司的特徵？\n(1) 它們也會在香港以外地方營運。\n(2) 它們都在香港的證券交易所上市。\n(3) 它們的僱員人數多於 100。", "options": ["只有 (1)", "只有 (1) 及 (2)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "跨國公司 (MNCs) 的核心特徵是在多個國家/地區有業務 (1對)。它們不一定要在香港上市 (2錯)，僱員人數也沒有統一的法定門檻 (3錯)。" },
		    { id: 201602, year: "2016", topic: "Management Functions", question: "相對於高架式架構，下列哪項是扁平式架構的特點？\n(1) 控制幅度較闊\n(2) 管理階層層數較少\n(3) 決策過程較短", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "扁平式架構層級少，意味著每一層管理的人數多（控制幅度闊），且溝通路徑短，決策較快。" },
		    { id: 201603, year: "2016", topic: "Management Principles", question: "在一家按地域劃分不同部門的公司，", "options": ["部門辦公室設立於在部門所管轄的區域。", "部門經理負責他所管轄區域的企業營運。", "部門銷售點只會出售部門所管轄區域生產的貨物。", "部門只在所管轄區域內聘請員工。"], answer: 1, explanation: "地域部門化 (Departmentalization by Geography) 是指經理負責特定區域的所有業務營運。辦公室不一定設在當地 (A非絕對)，貨源與員工招聘也不限於該區 (C, D錯)。" },
		    { id: 201604, year: "2016", topic: "Personal Finance", question: "安娜 65 歲退休，欲獲得回報但不欲承擔高風險。下列哪項投資工具最不適合她？", "options": ["定期存款", "儲蓄存款", "通脹掛鈎債券", "股票"], answer: 3, explanation: "股票屬於高風險投資工具，回報波動大且可能虧損本金，對風險厭惡且需退休保障的安娜最不適合。" },
		    { id: 201605, year: "2016", topic: "Accounting Principles", question: "心美於 2015 年賒購 $8000，2016 年 1 月才付款。根據 (1)，瑪莉應記錄這交易為 (2) 年度的銷貨。", "options": ["(1) 應計觀念；(2) 2015", "(1) 應計觀念；(2) 2016", "(1) 繼續經營假設；(2) 2015", "(1) 繼續經營假設；(2) 2016"], answer: 0, explanation: "根據應計觀念 (Accrual Concept)，收益應在賺取（即交易發生時）記錄，而非收到現金時。故屬 2015 年銷貨。" },
		    { id: 201606, year: "2016", topic: "Forms of Business Ownership", question: "下列哪項有關香港合營企業 (Joint Venture) 的描述是正確的？", "options": ["夥伴通常平分利潤。", "必定由一家本地與一家外國公司組成。", "是一家獨立於其所有夥伴之外的個體。", "利得稅率較普通合夥低。"], answer: 2, explanation: "合營企業是為特定項目成立的獨立法律個體 (C對)。利潤分配按協議 (A錯)，夥伴組合不限本地或外國 (B錯)，稅率通常與公司相同 (D錯)。" },
		    { id: 201607, year: "2016", topic: "Management Principles", question: "在下列哪些情況下，管理層應採用獨裁式領導？\n(1) 下屬只負責重複和簡單的工作\n(2) 下屬願意承擔責任\n(3) 公司經常需要迅速作出決定", "options": ["只有 (1)", "只有 (1) 及 (2)", "只有 (1) 及 (3)", "(2) 及 (3)"], answer: 2, explanation: "獨裁式領導適用於例行性低技術工作 (1對) 及需快決策的危機時刻 (3對)。若員工願擔責，應選民主或放任式 (2錯)。" },
		    { id: 201608, year: "2016", topic: "Management Functions", question: "前線管理人員負責：", "options": ["策略性決定。", "監督企業日常運作。", "制定公司政策和方向。"], answer: 1, explanation: "前線經理（如領班）負責日常監督 (2對)。策略、政策與方向是高層管理人員的職責 (1, 3錯)。" },
		    { id: 201609, year: "2016", topic: "Personal Finance", question: "信用卡用戶：\n(1) 可於海外購買貨物和服務。\n(2) 可在到期日前清付以避利息。\n(3) 利率較私人貸款低。", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "信用卡具海外支付及免息還款期 (1, 2對)；但信用卡結欠利率通常遠高於一般私人貸款 (3錯)。" },
		    { id: 201610, year: "2016", topic: "Management Principles", question: "下列哪項有關「分工」(Division of Labour) 的陳述是正確的？\n(1) 促進自動化生產 (2) 易於監察生產過程 (3) 員工易掌握工序", "options": ["只有 (1) 及 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 3, explanation: "分工將複雜工作細化，利於機械化、監督及提高熟練度。三者皆正確。" },
		    { id: 201611, year: "2016", topic: "Accounting", question: "下列哪個帳戶的結餘必定在試算表的借方？\n(1) 銀行手續費 (2) 銀行貸款 (3) 銀行存款", "options": ["只有 (1)", "只有 (2)", "只有 (1) 及 (3)", "只有 (2) 及 (3)"], answer: 0, explanation: "手續費是費用，必為借方 (1對)。貸款是負債，必為貸方 (2錯)。存款是資產，但在透支情況下會變貸方，故非「必定」(3錯)。" },
		    { id: 201612, year: "2016", topic: "Accounting", question: "下列哪項會影響銷貨成本 (COGS) 計算？", "options": ["辦公室租金", "送貨運費 (Carriage outwards)", "購貨交易折扣 (Trade discount)", "現金折扣 (Cash discount)"], answer: 2, explanation: "銷貨成本受購貨淨額影響，交易折扣直接降低購貨價格 (C對)。租金與送貨費屬費用；現金折扣屬收益。" },
		    { id: 201613, year: "2016", topic: "Accounting", question: "下列哪項有關非流動資產的陳述是正確的？", "options": ["購買成本超過 $100,000。", "它們是用於企業運作。", "它們的結餘會在損益表顯示。", "應收貨款是非流動資產。"], answer: 1, explanation: "非流動資產（如機器、汽車）旨在長期使用於業務 (B對)。其定義與金額無關 (A錯)；報表應在資產負債表 (C錯)；應收帳是流動資產 (D錯)。" },
		    { id: 201614, year: "2016", topic: "Finance", question: "初期存款 $100,000。第一至三年現金流：$20k, $35k, $55k。貼現率 5%。NPV？", "options": ["$10,000", "$9,523.81", "$4,761.90", "-$1,695.28"], answer: 3, explanation: "計算：$20,000/1.05 + 35,000/1.05^2 + 55,000/1.05^3 - 100,000 = 19,048 + 31,746 + 47,511 - 100,000 = -1,695$。" },
		    { id: 201615, year: "2016", topic: "Social Responsibility", question: "下列哪家是履行社會責任的公司？\n(1) 減排科技電力公司 (2) 接受福利機構訂單公司 (3) 鼓勵義工貿易公司", "options": ["只有 (1)", "只有 (1) 及 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 1, explanation: "環保 (1) 與公益 (3) 屬 CSR。接受訂單 (2) 僅屬一般商業交易，不具備社會責任屬性。" },
		    { id: 201616, year: "2016", topic: "Forms of Business Ownership", question: "下列哪項有關企業擁有權的陳述是正確的？\n(1) 公營公司政府全資 (2) 有限公司最少 2 人 (3) 名義合夥人不是擁有人", "options": ["只有 (1) 和 (2)", "只有 (1) 和 (3)", "只有 (2) 和 (3)", "(1)、(2) 和 (3)"], answer: 1, explanation: "公營公司由政府成立並擁有 (1對)；目前香港法例下有限公司最少 1 人即可成立 (2錯)；名義合夥人僅出借名聲，無實質擁有權 (3對)。" },
		    { id: 201617, year: "2016", topic: "Business Environment", question: "下列哪項是 CEPA 為香港企業帶來的利益？", "options": ["香港公司在內地不用繳稅。", "兩地資金可自由流動。", "原產香港貨品出口內地免關稅。", "香港可作為獨立個體加入 WTO。"], answer: 2, explanation: "CEPA 的核心利益之一是貨物貿易零關稅。不代表免除所有稅項 (A錯)；資金仍受外匯管制 (B錯)；香港本身已是 WTO 成員 (D無關)。" },
	  	    { id: 201618, year: "2016", topic: "Accounting", question: "下列哪項複式記帳是正確的？\n(1) 退貨予供應商：借購貨、貸購貨退出\n(2) 現金存銀行：借銀行存款、貸現金\n(3) 賒銷貨品：借應收貨款、貸銷貨", "options": ["只有 (1) 和 (2)", "只有 (1) 和 (3)", "只有 (2) 和 (3)", "(1)、(2) 和 (3)"], answer: 2, explanation: "(1) 錯誤：退貨予供應商應「貸購貨退出」(正確)，但應「借應付貨款」(錯誤)。(2) 與 (3) 的會計科目與方向皆正確。" },
		    { id: 201619, year: "2016", topic: "Finance", question: "現金 $500,000 半年期存款。哪個計劃回報最高？", "options": ["半年利息 $6,000", "季複息 年利率 2.4%", "半年複息 年利率 2.4%", "年複息 年利率 2.4%"], answer: 1, explanation: "A 利息：6000。B 半年利息：$500,000 * [(1 + 0.024/4)^2 - 1] = 6,036$。C/D 半年利息皆為 $500,000 * 0.012 = 6,000$。B 複息頻率最高，故利息最高。" },
		    { id: 201620, year: "2016", topic: "Business Environment", question: "下列說明中小型企業對本地經濟的重要？\n(1) 為大企業提供物料 (2) 供應獨特產品 (3) 稅收主要來源", "options": ["只有 (1) 和 (2)", "只有 (1) 和 (3)", "只有 (2) 和 (3)", "(1)、(2) 和 (3)"], answer: 0, explanation: "中小企是產業鏈的配套者 (1對) 及具靈活性 (2對)。大企業由於利潤豐厚，通常才是利得稅的主要來源 (3錯)。" },
		    { id: 201621, year: "2016", topic: "Accounting", question: "下列哪項應在帳戶的貸方 (Credit) 入帳？\n(1) 資本減少 (2) 應付貨款增加 (3) 銀行存款減少", "options": ["只有 (1) 和 (2)", "只有 (1) 和 (3)", "只有 (2) 和 (3)", "(1)、(2) 和 (3)"], answer: 2, explanation: "負債增加 (2) 與資產減少 (3) 記貸方。資本減少記借方 (1錯)。" },
		    { id: 201622, year: "2016", topic: "Management Functions", question: "下列哪項是為計劃定下目標所帶來的好處？\n(1) 清晰方向 (2) 監察表現 (3) 減輕工作量", "options": ["只有 (1) 和 (2)", "只有 (1) 和 (3)", "只有 (2) 及 (3)", "(1)、(2) 及 (3)"], answer: 0, explanation: "目標提供導航與控制依據 (1, 2對)。但目標往往具有挑戰性，通常不會減輕員工工作量 (3錯)。" },
		    { id: 201623, year: "2016", topic: "Accounting Equation", question: "資產 $980k，負債 $560k。期初資本 $100k。提用 $5,000*12。計算淨利。", "options": ["$180,000", "$260,000", "$325,000", "$380,000"], answer: 3, explanation: "期末資本 = 980k - 560k = 420k。期末資本 = 期初資本 + 淨利 - 提用。420k = 100k + 淨利 - 60k。淨利 = 380k。" },
		    { id: 201624, year: "2016", topic: "Management Principles", question: "下列哪項有關「統一命令」(Unity of Command) 的陳述是正確的？", "options": ["每名經理只負責一個項目。", "每名下屬只向一名上司報告。", "所有僱員朝相同目標。", "同一任務僱員收到相同指令。"], answer: 1, explanation: "核心定義：一名下屬只應擁有一位直接上司，以避免指示混亂。" },
		    { id: 201625, year: "2016", topic: "Business Environment", question: "自僱設計師卓文：\n(1) 有權不參加強積金 (2) 有權自願供款 (3) 移民可提早提取", "options": ["只有 (1)", "只有 (2)", "只有 (3)", "只有 (2) 及 (3)"], answer: 3, explanation: "自僱人士強制參加 (1錯)；可自願額外供款 (2對)；永久離港是法定可提早提取條件之一 (3對)。" },
		    { id: 201626, year: "2016", topic: "Accounting", question: "下列哪項不是公司財務報表對相關用家的主要用途？", "options": ["管理人員：制定發展策略", "僱員：評估保障", "政府：評估償還稅款能力", "債權人：決定是否賒銷"], answer: 2, explanation: "政府評估稅收是根據稅法計算「應繳額」，而非公司的「償還能力」(C最不符合)。" },
		    { id: 201627, year: "2016", topic: "Financial Market", question: "與主板比較，創業板 (GEM) 的要求：", "options": ["(1) 較寬鬆；(2) 較嚴謹", "(1) 較嚴謹；(2) 較寬鬆", "(1) 較嚴謹；(2) 較嚴謹", "(1) 較寬鬆；(2) 較寬鬆"], answer: 3, explanation: "GEM 針對增長型企業，其營運記錄、市值與盈利門檻均低於主板。" },
		    { id: 201628, year: "2016", topic: "Forms of Business Ownership", question: "成立較易、稅率較低。東主須對其餘東主決策負責。", "options": ["合夥", "獨資", "私人有限公司", "公眾有限公司"], answer: 0, explanation: "合夥具備「共同負債」(Joint and Several Liability) 的法律責任，且稅率低於公司 (A對)。獨資只有一人，無所謂「其餘東主」。" },
		    { id: 201629, year: "2016", topic: "Accounting", question: "購貨 $75k、退出 $3k、期初存貨 $15k、期末 $27k。計算銷貨成本。", "options": ["$54,500", "$58,000", "$60,000", "$63,000"], answer: 2, explanation: "銷貨成本 = 15,000 + (75,000 - 3,000) - 27,000 = 60,000。" },
		    { id: 201630, year: "2016", topic: "Accounting", question: "淨利 $9k，費用 (電費 $10k、薪金 $36.5k、折扣 $3.5k)。毛利？", "options": ["$59,000", "$57,000", "$54,000", "$53,500"], answer: 0, explanation: "毛利 = 淨利 + 總費用 = 9,000 + (10,000 + 36,500 + 3,500) = 59,000。" }	
	
		
		];

        // 這是全域變數，會混合本地題目 + 雲端題目
        window.BAFS_DB = [...REAL_QUESTIONS];
        let CLOUD_QUESTIONS_CACHE = [];

        // === 2. GitHub 題庫連結 (2012-2019) ===
        // 請將您的 QUESTIONS.js 檔案的 "Raw" 連結貼在這裡
        // 建議使用: https://your-username.github.io/your-repo/QUESTIONS.js
        const GITHUB_DATA_URL = ''; 

        // === 3. FIREBASE CONFIG 設定區 ===
        const YOUR_FIREBASE_CONFIG = {
            apiKey: "AIzaSyBt7EdhDqdpNQuh1jo6AmCNO3Vgso-c8pg",
            authDomain: "bafs-140c4.firebaseapp.com",
            projectId: "bafs-140c4",
            storageBucket: "bafs-140c4.firebasestorage.app",
            messagingSenderId: "859626093746",
            appId: "1:859626093746:web:8e0ffb9616bce754d0ddab"
        }; 

        const firebaseConfig = YOUR_FIREBASE_CONFIG || JSON.parse(new URLSearchParams(window.location.search).get('__firebase_config') || '{}');
        
        let db, auth, user;
        // Robust appId handling
        let appId = typeof __app_id !== 'undefined' ? __app_id : (firebaseConfig.projectId || 'default-app-id');

        try {
            if (Object.keys(firebaseConfig).length > 0) {
                const app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);

                // 監聽登入狀態
                onAuthStateChanged(auth, (u) => {
                    user = u;
                    appLogic.updateAuthUI(u);
                    
                    if(u) {
                        // 登入後載入雲端數據
                        appLogic.loadCloudQuestions();
                        appLogic.loadCloudStats();
                        appLogic.loadExternalQuestions(); // Load GitHub Data
                    } else {
                         // 強制登入 (匿名)
                         signInAnonymously(auth).catch(e => {
                             console.error("Anonymous auth failed", e);
                             alert("自動登入失敗，請檢查網絡");
                         });
                    }
                });
            } else {
                console.warn("No Firebase Config found. App running in static mode.");
            }
        } catch (e) {
            console.error("Firebase Init Error:", e);
        }

        // === 4. APP LOGIC ===
        class BAFSApp {
            constructor() {
                this.currentQuestions = [];
                this.currentIndex = 0;
                this.score = 0;
                this.mode = 'practice';
                this.userAnswers = {};
                this.timerInterval = null;
                this.timeRemaining = 75 * 60;
                this.selectedYear = null;
                this.mistakes = JSON.parse(localStorage.getItem('bafs_mistakes')) || [];
                this.stats = JSON.parse(localStorage.getItem('bafs_stats')) || { total: 0, correct: 0 };
                this.currentEditingId = null; // null = add mode, string = edit mode ID
                
                this.init();
            }

            init() {
                // 初次渲染 (只顯示靜態題目)
                this.renderYears();
                this.updateStatsUI();
            }

            updateAuthUI(user) {
                const userDisplay = document.getElementById('user-display');
                if (user) {
                    userDisplay.classList.remove('hidden');
                    document.getElementById('username-span').innerText = '訪客 ' + user.uid.substring(0, 5);
                } else {
                    userDisplay.classList.add('hidden');
                }
            }

            // --- Load External Questions from GitHub ---
            async loadExternalQuestions() {
                if (!GITHUB_DATA_URL) return;

                const loadingBar = document.getElementById('external-loading-bar');
                if(loadingBar) loadingBar.classList.remove('hidden');

                try {
                    const response = await fetch(GITHUB_DATA_URL);
                    const text = await response.text();
                    
                    // Attempt to parse text. It might be pure JSON or JS with "window.EXTERNAL_QUESTIONS ="
                    let jsonData;
                    if (text.trim().startsWith('[')) {
                        jsonData = JSON.parse(text);
                    } else {
                        // Very basic extraction if it's a JS file
                        const jsonStr = text.substring(text.indexOf('['), text.lastIndexOf(']') + 1);
                        jsonData = JSON.parse(jsonStr);
                    }

                    if (Array.isArray(jsonData)) {
                        // Merge uniquely
                        const currentIds = new Set(window.BAFS_DB.map(q => q.id));
                        const newQs = jsonData.filter(q => !currentIds.has(q.id));
                        
                        window.BAFS_DB = [...window.BAFS_DB, ...newQs];
                        
                        // Sort by year desc
                        window.BAFS_DB.sort((a, b) => b.year.toString().localeCompare(a.year.toString()) || a.id - b.id);

                        this.renderYears();
                        this.showToast(`成功載入 ${newQs.length} 條額外題目！`);
                    }
                } catch (e) {
                    console.error("Failed to load GitHub questions:", e);
                    this.showToast("無法載入外部題庫 (GitHub)");
                } finally {
                    if(loadingBar) loadingBar.classList.add('hidden');
                }
            }

            // --- Database Sync & Management ---
            async loadCloudQuestions() {
                if (!db) return;
                try {
                    const qRef = collection(db, 'artifacts', appId, 'public', 'data', 'questions');
                    const snapshot = await getDocs(qRef);
                    
                    CLOUD_QUESTIONS_CACHE = [];
                    snapshot.forEach(doc => {
                        // Tag cloud questions with isCloud: true and their Firestore doc id
                        CLOUD_QUESTIONS_CACHE.push({ ...doc.data(), id: doc.id, isCloud: true });
                    });

                    // Merge static + cloud + external(already merged potentially)
                    // We need a strategy to not duplicate. 
                    // BAFS_DB is dynamic. Let's just append cloud ones that are not there.
                    const currentIds = new Set(window.BAFS_DB.map(q => q.id));
                    const newQs = CLOUD_QUESTIONS_CACHE.filter(q => !currentIds.has(q.id));
                    
                    window.BAFS_DB = [...window.BAFS_DB, ...newQs];
                    
                    this.renderYears();
                } catch (e) {
                    console.error("Failed to load cloud questions:", e);
                }
            }
            
            // --- Navigation ---
            router(viewId) {
                document.querySelectorAll('.hidden-page, #home-view').forEach(el => {
                    if(el.id !== 'mobile-menu') el.style.display = 'none';
                });
                
                const target = document.getElementById(viewId + '-view');
                if (target) {
                    target.style.display = 'block';
                    window.scrollTo(0, 0);
                    
                    if(viewId === 'mistakes') this.renderMistakes();
                    if(viewId === 'leaderboard') this.loadLeaderboard();
                }
            }

            toggleDarkMode() {
                document.documentElement.classList.toggle('dark');
            }

            showToast(msg) {
                const t = document.getElementById('toast');
                document.getElementById('toast-msg').innerText = msg;
                t.style.transform = 'translate(-50%, 0)';
                setTimeout(() => {
                    t.style.transform = 'translate(-50%, 5rem)';
                }, 3000);
            }

            // --- Home & Selection ---
            renderYears() {
                const grid = document.getElementById('year-grid');
                grid.innerHTML = '';
                
                // Sort years desc
                const years = [...new Set(window.BAFS_DB.map(q => q.year))].sort((a,b) => {
                    // Handle "Sample Paper" etc. which are strings
                    if (isNaN(a) && !isNaN(b)) return -1;
                    if (!isNaN(a) && isNaN(b)) return 1;
                    if (isNaN(a) && isNaN(b)) return a.localeCompare(b);
                    return b - a;
                });
                
                if (years.length === 0) {
                    grid.innerHTML = '<div class="col-span-3 text-center text-gray-500">正在載入題庫...</div>';
                    return;
                }

                years.forEach(year => {
                    const btn = document.createElement('button');
                    btn.className = "cartoon-card p-4 hover:bg-brand-blue hover:text-white font-bold text-lg transition duration-200 flex flex-col items-center justify-center h-24 dark:text-gray-900";
                    btn.innerHTML = `
                        <span>${year}</span>
                        <span class="text-xs font-normal opacity-70 mt-1">練習</span>
                    `;
                    btn.onclick = () => this.openModeModal(year);
                    grid.appendChild(btn);
                });
            }

            openModeModal(year) {
                this.selectedYear = year;
                document.getElementById('modal-year-title').innerText = `${year} MC Paper 1`;
                document.getElementById('mode-modal').classList.remove('hidden');
            }

            startRandomMock() {
                if (window.BAFS_DB.length === 0) {
                    this.showToast("題庫是空的！");
                    return;
                }
                const shuffled = [...window.BAFS_DB].sort(() => 0.5 - Math.random());
                this.currentQuestions = shuffled.slice(0, 24); 
                this.selectedYear = "隨機模擬卷";
                this.openModeModal("隨機模擬卷"); 
            }

            startMiniQuiz() {
                if (window.BAFS_DB.length === 0) {
                    this.showToast("題庫是空的！");
                    return;
                }
                const shuffled = [...window.BAFS_DB].sort(() => 0.5 - Math.random());
                this.currentQuestions = shuffled.slice(0, 20);
                this.selectedYear = "極速小測";
                this.openModeModal("極速小測");
            }

            // --- Quiz Logic ---
            startQuiz(mode, isSearch = false) {
                document.getElementById('mode-modal').classList.add('hidden');
                this.mode = mode;
                
                if (!isSearch && this.selectedYear !== "隨機模擬卷" && this.selectedYear !== "極速小測") {
                    this.currentQuestions = window.BAFS_DB.filter(q => q.year === this.selectedYear);
                }

                if (this.currentQuestions.length === 0) {
                    this.showToast("此年份暫無題目");
                    return;
                }

                this.currentIndex = 0;
                this.score = 0;
                this.userAnswers = {};
                this.router('quiz');

                document.getElementById('quiz-title').innerText = this.selectedYear;
                document.getElementById('quiz-mode-label').innerText = mode === 'exam' ? 'MOCK EXAM MODE' : 'PRACTICE MODE';
                document.getElementById('btn-next').classList.add('hidden');
                document.getElementById('btn-submit').classList.add('hidden');

                const timerDisplay = document.getElementById('timer-display');
                if (mode === 'exam') {
                    if (this.selectedYear.includes("模擬卷")) {
                        this.timeRemaining = 30 * 60;
                    } else if (this.selectedYear.includes("小測")) {
                        this.timeRemaining = 20 * 60;
                    } else {
                        this.timeRemaining = 30 * 60;
                    }
                    timerDisplay.classList.remove('hidden');
                    this.startTimer();
                } else {
                    timerDisplay.classList.add('hidden');
                    clearInterval(this.timerInterval);
                }

                this.renderQuestion();
            }

            startTimer() {
                clearInterval(this.timerInterval);
                const display = document.getElementById('timer-display');
                
                this.timerInterval = setInterval(() => {
                    this.timeRemaining--;
                    const m = Math.floor(this.timeRemaining / 60);
                    const s = this.timeRemaining % 60;
                    display.innerText = `${m}:${s < 10 ? '0'+s : s}`;
                    
                    if (this.timeRemaining <= 0) {
                        this.endQuizEarly();
                    }
                }, 1000);
            }

            renderQuestion() {
                const q = this.currentQuestions[this.currentIndex];
                const total = this.currentQuestions.length;
                
                document.getElementById('q-number').innerText = `${this.currentIndex + 1}/${total}`;
                // Set the question source badge text (e.g., 2021 Q1)
                const qSourceText = q.id ? `${q.year} Q${String(q.id).slice(-2).replace(/^0+/, '')}` : `${q.year}`;
                document.getElementById('q-source').innerText = qSourceText;
                
                document.getElementById('q-text').innerText = q.question;
                
                const pct = ((this.currentIndex) / total) * 100;
                document.getElementById('quiz-progress').style.width = `${pct}%`;

                const optsContainer = document.getElementById('q-options');
                optsContainer.innerHTML = '';
                
                q.options.forEach((opt, idx) => {
                    const isSelected = this.userAnswers[q.id || this.currentIndex] === idx; 
                    const qId = q.id || this.currentIndex;

                    const label = document.createElement('label');
                    label.className = "cursor-pointer block relative group";
                    label.innerHTML = `
                        <input type="radio" name="opt" class="hidden option-input" value="${idx}" ${isSelected ? 'checked' : ''} onchange="app.selectOption(${idx})">
                        <div class="p-4 rounded-xl border-2 border-gray-300 dark:border-gray-600 hover:border-black dark:hover:border-white transition flex items-center gap-3">
                            <span class="w-8 h-8 rounded-full border-2 border-gray-400 flex items-center justify-center font-bold text-gray-500 group-hover:bg-black group-hover:text-white transition-colors">
                                ${String.fromCharCode(65 + idx)}
                            </span>
                            <span class="text-lg">${opt}</span>
                        </div>
                    `;
                    optsContainer.appendChild(label);
                });

                document.getElementById('explanation-box').classList.add('hidden');
                
                document.getElementById('btn-prev').disabled = this.currentIndex === 0;
                
                if (this.currentIndex === total - 1) {
                    document.getElementById('btn-next').classList.add('hidden');
                    document.getElementById('btn-submit').classList.remove('hidden');
                } else {
                    document.getElementById('btn-next').classList.remove('hidden');
                    document.getElementById('btn-submit').classList.add('hidden');
                }

                const qId = q.id || this.currentIndex;
                if (this.mode === 'practice' && this.userAnswers[qId] !== undefined) {
                    this.showFeedback(q, this.userAnswers[qId]);
                }
            }

            selectOption(idx) {
                const q = this.currentQuestions[this.currentIndex];
                const qId = q.id || this.currentIndex;
                
                if (this.mode === 'practice' && this.userAnswers[qId] !== undefined) return;
                
                this.userAnswers[qId] = idx;

                if (this.mode === 'practice') {
                    this.showFeedback(q, idx);
                }
            }

            showFeedback(q, selectedIdx) {
                const isCorrect = selectedIdx === q.answer;
                const opts = document.querySelectorAll('.option-input + div');
                
                opts[selectedIdx].classList.remove('border-gray-300', 'border-black');
                opts[selectedIdx].classList.add(isCorrect ? 'bg-green-100' : 'bg-red-100', isCorrect ? 'border-green-500' : 'border-red-500', 'text-black');
                
                if (!isCorrect) {
                    opts[q.answer].classList.add('bg-green-100', 'border-green-500', 'text-black');
                    this.addMistake(q);
                }

                const expBox = document.getElementById('explanation-box');
                document.getElementById('explanation-text').innerText = q.explanation;
                expBox.classList.remove('hidden');

                document.querySelectorAll('input[type="radio"]').forEach(el => el.disabled = true);
            }

            nextQuestion() {
                if (this.currentIndex < this.currentQuestions.length - 1) {
                    this.currentIndex++;
                    this.renderQuestion();
                }
            }

            prevQuestion() {
                if (this.currentIndex > 0) {
                    this.currentIndex--;
                    this.renderQuestion();
                }
            }

            addMistake(question) {
                const qId = question.id || question.question; 
                if (!this.mistakes.find(m => (m.id || m.question) === qId)) {
                    this.mistakes.push(question);
                    localStorage.setItem('bafs_mistakes', JSON.stringify(this.mistakes));
                }
            }

            endQuizEarly() {
                if(confirm("確定結束練習並查看成績？")) {
                    this.submitQuiz();
                }
            }

            submitQuiz() {
                clearInterval(this.timerInterval);
                
                let correctCount = 0;
                this.currentQuestions.forEach(q => {
                    const key = q.id || this.currentQuestions.indexOf(q);
                    const userAns = this.userAnswers[q.id];
                    
                    if (userAns === q.answer) {
                        correctCount++;
                    } else if (this.mode === 'exam' && userAns !== undefined) {
                        this.addMistake(q);
                    }
                });

                this.score = correctCount;
                const total = this.currentQuestions.length;
                
                this.stats.total += total;
                this.stats.correct += correctCount;
                localStorage.setItem('bafs_stats', JSON.stringify(this.stats));
                this.updateStatsUI();

                document.getElementById('result-subtitle').innerText = `${this.selectedYear} • ${this.mode === 'exam' ? '模擬考' : '練習'}`;
                document.getElementById('result-score').innerText = this.score;
                document.getElementById('result-total').innerText = total;
                document.getElementById('result-correct').innerText = correctCount;
                document.getElementById('result-wrong').innerText = total - correctCount;

                this.router('result');
                
                if (correctCount / total > 0.5) {
                    this.fireConfetti();
                }

                // 自動上傳分數
                setTimeout(() => {
                    if (user) {
                        this.saveToLeaderboard(true);
                    } else {
                        signInAnonymously(auth).then(() => {
                            this.saveToLeaderboard(true);
                        }).catch(e => console.error("Auto login failed during submit", e));
                    }
                }, 500);
            }

            fireConfetti() {
                for(let i=0; i<50; i++) {
                    const c = document.createElement('div');
                    c.className = 'confetti';
                    c.style.left = Math.random() * 100 + 'vw';
                    c.style.backgroundColor = ['#FFD93D', '#4D96FF', '#FF6B6B'][Math.floor(Math.random()*3)];
                    c.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    document.body.appendChild(c);
                    setTimeout(() => c.remove(), 4000);
                }
            }

            renderMistakes() {
                const list = document.getElementById('mistakes-list');
                const emptyMsg = document.getElementById('no-mistakes-msg');
                list.innerHTML = '';

                if (this.mistakes.length === 0) {
                    emptyMsg.classList.remove('hidden');
                    return;
                }
                emptyMsg.classList.add('hidden');

                this.mistakes.forEach(q => {
                    const div = document.createElement('div');
                    div.className = "cartoon-card p-6 bg-white dark:bg-gray-800 relative";
                    div.innerHTML = `
                        <div class="absolute top-4 right-4 text-xs font-bold text-gray-400">${q.year}</div>
                        <h4 class="font-bold text-lg mb-3 pr-8">${q.question}</h4>
                        <div class="space-y-2 mb-4">
                            ${q.options.map((opt, i) => `
                                <div class="px-3 py-2 rounded border ${i === q.answer ? 'bg-green-100 border-green-500 text-black' : 'border-gray-200 dark:border-gray-600'}">
                                    ${String.fromCharCode(65+i)}. ${opt}
                                </div>
                            `).join('')}
                        </div>
                        <div class="text-sm bg-blue-50 dark:bg-blue-900/20 p-3 rounded text-brand-blue dark:text-blue-300">
                            <strong>詳解：</strong> ${q.explanation}
                        </div>
                        <button class="mt-4 text-xs text-red-500 underline font-bold" onclick="app.removeMistake('${q.id}')">移除此題</button>
                    `;
                    list.appendChild(div);
                });
            }

            removeMistake(id) {
                this.mistakes = this.mistakes.filter(m => m.id != id); 
                localStorage.setItem('bafs_mistakes', JSON.stringify(this.mistakes));
                this.renderMistakes();
                this.updateStatsUI();
            }

            clearMistakes() {
                if(confirm("確定清除所有錯題？")) {
                    this.mistakes = [];
                    localStorage.setItem('bafs_mistakes', JSON.stringify([]));
                    this.renderMistakes();
                    this.updateStatsUI();
                }
            }

            updateStatsUI() {
                document.getElementById('stat-total-done').innerText = this.stats.total;
                const acc = this.stats.total === 0 ? 0 : Math.round((this.stats.correct / this.stats.total) * 100);
                document.getElementById('stat-accuracy').innerText = acc + '%';
                document.getElementById('stat-mistakes').innerText = this.mistakes.length;
            }

            shareResult() {
                const text = `我剛在 BAFS 狀元工廠 (${this.selectedYear}) 拿到 ${this.score}/${this.currentQuestions.length} 分！快來挑戰！`;
                if (navigator.share) {
                    navigator.share({ title: 'BAFS 成績', text: text, url: window.location.href });
                } else {
                    navigator.clipboard.writeText(text);
                    this.showToast("成績已複製到剪貼簿！");
                }
            }

            // Modified to support Auto-Upload
            async saveToLeaderboard(isAuto = false) {
                if (!user) {
                    // Anonymous login handles this
                    return;
                }
                
                let nickname;
                if (isAuto) {
                    // 自動模式：直接產生暱稱，不詢問
                    nickname = "訪客 " + user.uid.substring(0, 5);
                    this.showToast("正在自動上傳成績...");
                } else {
                    nickname = prompt("請輸入你在龍虎榜上的暱稱：", "訪客 " + user.uid.substring(0, 5));
                }
                
                if (!nickname) return;

                const acc = Math.round((this.score / this.currentQuestions.length) * 100);

                try {
                    const scoresRef = collection(db, 'artifacts', appId, 'public', 'data', 'leaderboard');
                    await addDoc(scoresRef, {
                        nickname: nickname,
                        score: this.score,
                        accuracy: acc,
                        year: this.selectedYear,
                        timestamp: serverTimestamp()
                    });
                    
                    if (isAuto) {
                        document.getElementById('auto-upload-msg').classList.remove('hidden');
                        this.showToast("✅ 成績已自動上傳至龍虎榜！");
                    } else {
                        this.showToast("上傳成功！");
                        setTimeout(() => this.router('leaderboard'), 1000);
                    }
                } catch (e) {
                    console.error(e);
                    if (!isAuto) this.showToast("上傳失敗，請檢查資料庫規則。");
                }
            }

            async loadLeaderboard() {
                const tbody = document.getElementById('leaderboard-body');
                tbody.innerHTML = '<tr><td colspan="4" class="p-4 text-center">載入中...</td></tr>';
                
                try {
                    const scoresRef = collection(db, 'artifacts', appId, 'public', 'data', 'leaderboard');
                    const q = query(scoresRef); 
                    const querySnapshot = await getDocs(q);
                    
                    let data = [];
                    querySnapshot.forEach((doc) => {
                        data.push(doc.data());
                    });

                    data.sort((a, b) => b.score - a.score);
                    data = data.slice(0, 50);

                    tbody.innerHTML = '';
                    if (data.length === 0) {
                        tbody.innerHTML = '<tr><td colspan="4" class="p-4 text-center">暫無數據，快來搶第一！</td></tr>';
                        return;
                    }

                    data.forEach((entry, idx) => {
                        let rankClass = "";
                        let icon = "";
                        if (idx === 0) { rankClass = "text-brand-yellow font-bold text-xl"; icon = "👑"; }
                        else if (idx === 1) { rankClass = "text-gray-400 font-bold text-lg"; icon = "🥈"; }
                        else if (idx === 2) { rankClass = "text-orange-400 font-bold text-lg"; icon = "🥉"; }

                        const row = `
                            <tr class="border-b dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700">
                                <td class="p-4 ${rankClass}">${icon} ${idx + 1}</td>
                                <td class="p-4 font-bold">${entry.nickname}</td>
                                <td class="p-4 text-sm text-gray-500 hidden md:table-cell">${entry.year}</td>
                                <td class="p-4 text-right font-mono font-bold text-brand-blue">${entry.score}</td>
                            </tr>
                        `;
                        tbody.innerHTML += row;
                    });

                } catch (e) {
                    console.error(e);
                    tbody.innerHTML = `<tr><td colspan="4" class="p-4 text-center text-red-500">
                        無法載入數據<br>
                        <span class="text-xs text-gray-500">${e.message}</span><br>
                        <span class="text-xs">請檢查 Firestore 規則是否設為 Test Mode</span>
                    </td></tr>`;
                }
            }

            async loadCloudStats() {
                if(!user) return;
                try {
                    const docRef = doc(db, 'artifacts', appId, 'users', user.uid, 'progress', 'main');
                    // Future sync logic
                } catch(e) { }
            }
        }

        window.app = new BAFSApp();
        window.router = (view) => app.router(view);

    </script>
</body>
</html>

